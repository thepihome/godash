{
  "version": 3,
  "sources": ["../../../src/utils/db.js", "../../../src/utils/cors.js", "../../../src/middleware/auth.js", "../../../src/routes/matches.js", "../../../src/routes/auth.js", "../../../src/routes/jobs.js", "../../../src/routes/resumes.js", "../../../src/router.js", "../../../src/routes/candidates.js", "../../../src/routes/candidateProfiles.js", "../../../src/utils/activityLog.js", "../../../src/routes/timesheets.js", "../../../src/routes/kpis.js", "../../../src/routes/users.js", "../../../src/routes/groups.js", "../../../src/routes/permissions.js", "../../../src/routes/crm.js", "../../../src/routes/activityLogs.js", "../../../src/routes/jobRoles.js", "../../../worker.js"],
  "sourceRoot": "/Users/harshadbhandwaldar/gobunny/backend/.wrangler/tmp/deploy-zBL21i",
  "sourcesContent": ["/**\n * Database utilities for D1\n */\n\n/**\n * Execute a query with parameters (SELECT)\n */\nexport async function query(env, sql, params = []) {\n  try {\n    let stmt = env.DB.prepare(sql);\n    \n    // Bind parameters if provided\n    if (params.length > 0) {\n      stmt = stmt.bind(...params);\n    }\n    \n    const result = await stmt.all();\n    return result.results || [];\n  } catch (error) {\n    console.error('Database query error:', error);\n    throw error;\n  }\n}\n\n/**\n * Execute a query and return first row\n */\nexport async function queryOne(env, sql, params = []) {\n  const results = await query(env, sql, params);\n  return results[0] || null;\n}\n\n/**\n * Execute an INSERT/UPDATE/DELETE and return the last insert ID\n */\nexport async function execute(env, sql, params = []) {\n  try {\n    let stmt = env.DB.prepare(sql);\n    \n    if (params.length > 0) {\n      stmt = stmt.bind(...params);\n    }\n    \n    const result = await stmt.run();\n    \n    // D1 run() returns: { success: true, meta: { duration: ..., last_row_id: ..., rows_read: ..., rows_written: ... } }\n    // Log the full result for debugging\n    console.log('D1 execute result:', JSON.stringify(result));\n    \n    // Extract last_row_id from meta\n    const lastRowId = result.meta?.last_row_id ?? null;\n    \n    if (!lastRowId && result.meta) {\n      console.warn('No last_row_id in result.meta. Full meta:', JSON.stringify(result.meta));\n    }\n    \n    return { \n      success: true, \n      meta: {\n        ...result.meta,\n        last_row_id: lastRowId\n      },\n      lastInsertRowid: lastRowId,\n      rawResult: result // Include for debugging\n    };\n  } catch (error) {\n    console.error('Database execute error:', error);\n    console.error('SQL:', sql);\n    console.error('Params:', params);\n    throw error;\n  }\n}\n\n/**\n * Parse JSON fields from database results\n */\nexport function parseJsonFields(row, fields = []) {\n  const parsed = { ...row };\n  fields.forEach(field => {\n    if (parsed[field] && typeof parsed[field] === 'string') {\n      try {\n        parsed[field] = JSON.parse(parsed[field]);\n      } catch (e) {\n        parsed[field] = [];\n      }\n    }\n  });\n  return parsed;\n}\n\n/**\n * Stringify JSON fields for database storage\n */\nexport function stringifyJsonFields(data, fields = []) {\n  const stringified = { ...data };\n  fields.forEach(field => {\n    if (stringified[field] && typeof stringified[field] === 'object') {\n      stringified[field] = JSON.stringify(stringified[field]);\n    }\n  });\n  return stringified;\n}\n\n", "/**\n * CORS utilities for Cloudflare Workers\n */\n\n/**\n * Normalize URL by removing trailing slash\n */\nfunction normalizeOrigin(origin) {\n  if (!origin) return origin;\n  return origin.replace(/\\/$/, '');\n}\n\n/**\n * Get CORS headers based on request origin\n */\nexport function getCorsHeaders(env, requestOrigin = null) {\n  const allowedOrigin = normalizeOrigin(env.FRONTEND_URL || '*');\n  \n  // If we have a request origin, check if it matches (normalized)\n  let origin = '*';\n  if (requestOrigin) {\n    const normalizedRequestOrigin = normalizeOrigin(requestOrigin);\n    if (allowedOrigin === '*' || normalizedRequestOrigin === allowedOrigin) {\n      origin = normalizedRequestOrigin;\n    }\n  } else if (allowedOrigin !== '*') {\n    origin = allowedOrigin;\n  }\n  \n  return {\n    'Access-Control-Allow-Origin': origin,\n    'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',\n    'Access-Control-Allow-Headers': 'Content-Type, Authorization',\n    'Access-Control-Allow-Credentials': 'true',\n  };\n}\n\n/**\n * Get origin from request (supports both Request object and string)\n */\nfunction getOriginFromRequest(request) {\n  if (typeof request === 'string') {\n    return request;\n  }\n  if (request && typeof request === 'object' && 'headers' in request) {\n    return request.headers.get('Origin');\n  }\n  return null;\n}\n\nexport const corsHeaders = {\n  'Access-Control-Allow-Origin': '*', // Default, will be overridden\n  'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',\n  'Access-Control-Allow-Headers': 'Content-Type, Authorization',\n  'Access-Control-Allow-Credentials': 'true',\n};\n\nexport function handleCORS(env, requestOrOrigin = null) {\n  const requestOrigin = getOriginFromRequest(requestOrOrigin);\n  const headers = getCorsHeaders(env, requestOrigin);\n  return new Response(null, {\n    status: 204,\n    headers,\n  });\n}\n\nexport function addCorsHeaders(response, env, requestOrOrigin = null) {\n  const requestOrigin = getOriginFromRequest(requestOrOrigin);\n  const headers = getCorsHeaders(env, requestOrigin);\n  const newHeaders = new Headers(response.headers);\n  Object.entries(headers).forEach(([key, value]) => {\n    newHeaders.set(key, value);\n  });\n  return new Response(response.body, {\n    status: response.status,\n    statusText: response.statusText,\n    headers: newHeaders,\n  });\n}\n\n", "/**\n * Authentication middleware for Cloudflare Workers\n * Using Web Crypto API for JWT verification\n */\n\n/**\n * Base64 URL decode\n */\nfunction base64UrlDecode(str) {\n  str = str.replace(/-/g, '+').replace(/_/g, '/');\n  while (str.length % 4) {\n    str += '=';\n  }\n  return atob(str);\n}\n\n/**\n * Decode JWT without verification (for getting payload)\n */\nfunction decodeJWT(token) {\n  try {\n    const parts = token.split('.');\n    if (parts.length !== 3) return null;\n    const payload = JSON.parse(base64UrlDecode(parts[1]));\n    return payload;\n  } catch (e) {\n    return null;\n  }\n}\n\n/**\n * Authenticate request using JWT token\n */\nexport async function authenticate(request, env) {\n  try {\n    const authHeader = request.headers.get('Authorization');\n    if (!authHeader || !authHeader.startsWith('Bearer ')) {\n      return { error: 'No token provided', status: 401 };\n    }\n\n    const token = authHeader.substring(7);\n    \n    // Decode token to get user ID (simplified - in production, verify signature)\n    const decoded = decodeJWT(token);\n    if (!decoded || !decoded.userId) {\n      return { error: 'Invalid token', status: 401 };\n    }\n\n    // Check expiration\n    if (decoded.exp && decoded.exp < Date.now() / 1000) {\n      return { error: 'Token expired', status: 401 };\n    }\n\n    const userId = decoded.userId;\n\n    // Get user from database\n    const { queryOne } = await import('../utils/db.js');\n    const user = await queryOne(\n      env,\n      'SELECT id, email, first_name, last_name, role, is_active FROM users WHERE id = ?',\n      [userId]\n    );\n\n    if (!user || !user.is_active) {\n      return { error: 'Invalid token', status: 401 };\n    }\n\n    return { user };\n  } catch (error) {\n    console.error('Authentication error:', error);\n    return { error: 'Invalid token', status: 401 };\n  }\n}\n\n/**\n * Authorize user based on roles\n */\nexport function authorize(...allowedRoles) {\n  return (user) => {\n    if (!user) {\n      return { error: 'Authentication required', status: 401 };\n    }\n\n    if (!allowedRoles.includes(user.role)) {\n      return { error: 'Insufficient permissions', status: 403 };\n    }\n\n    return null;\n  };\n}\n\n", "/**\n * Matches routes for Cloudflare Workers\n * Handles job matching based on job classification\n */\n\nimport { query, queryOne, execute } from '../utils/db.js';\nimport { addCorsHeaders } from '../utils/cors.js';\nimport { authorize } from '../middleware/auth.js';\n\n// Auto-match candidates to jobs based on job classification\nexport async function autoMatchByClassification(env, jobId) {\n  try {\n    // Get job with classification\n    const job = await queryOne(env,\n      `SELECT j.*, jr.name as job_classification_name \n       FROM jobs j \n       LEFT JOIN job_roles jr ON j.job_classification = jr.id \n       WHERE j.id = ?`,\n      [jobId]\n    );\n\n    if (!job || !job.job_classification) {\n      return { matched: 0, message: 'Job not found or has no classification' };\n    }\n\n    // Get job role name\n    const jobRoleName = job.job_classification_name;\n\n    // Find candidates with matching job classification\n    const candidates = await query(env,\n      `SELECT DISTINCT u.id as candidate_id, cp.current_job_title\n       FROM users u\n       INNER JOIN candidate_profiles cp ON u.id = cp.user_id\n       WHERE u.role = 'candidate' \n       AND u.is_active = 1\n       AND cp.current_job_title = ?`,\n      [jobRoleName]\n    );\n\n    let matched = 0;\n    const matches = [];\n\n    for (const candidate of candidates) {\n      // Get candidate's primary resume\n      const resume = await queryOne(env,\n        'SELECT * FROM resumes WHERE user_id = ? ORDER BY uploaded_at DESC LIMIT 1',\n        [candidate.candidate_id]\n      );\n\n      if (!resume) continue;\n\n      // Calculate basic match score (classification match = 50 points base)\n      let matchScore = 50;\n\n      // Add points for skills match if available\n      if (resume.skills && job.required_skills) {\n        try {\n          const resumeSkills = typeof resume.skills === 'string' \n            ? JSON.parse(resume.skills) \n            : resume.skills;\n          const jobSkills = typeof job.required_skills === 'string'\n            ? JSON.parse(job.required_skills)\n            : job.required_skills;\n\n          if (Array.isArray(resumeSkills) && Array.isArray(jobSkills)) {\n            const matchingSkills = resumeSkills.filter(skill =>\n              jobSkills.some(js => js.toLowerCase() === skill.toLowerCase())\n            );\n            matchScore += Math.min(30, (matchingSkills.length / Math.max(jobSkills.length, 1)) * 30);\n          }\n        } catch (e) {\n          console.error('Error parsing skills:', e);\n        }\n      }\n\n      // Add points for experience match\n      if (resume.experience_years && job.experience_level) {\n        const expMap = { 'entry': 0, 'junior': 1, 'mid': 3, 'senior': 5, 'executive': 10 };\n        const requiredExp = expMap[job.experience_level.toLowerCase()] || 0;\n        if (resume.experience_years >= requiredExp) {\n          matchScore += 20;\n        } else {\n          matchScore += (resume.experience_years / Math.max(requiredExp, 1)) * 20;\n        }\n      }\n\n      matchScore = Math.min(100, Math.round(matchScore));\n\n      // Check if match already exists\n      const existingMatch = await queryOne(env,\n        'SELECT id FROM job_matches WHERE job_id = ? AND candidate_id = ?',\n        [jobId, candidate.candidate_id]\n      );\n\n      if (existingMatch) {\n        // Update existing match\n        await execute(env,\n          `UPDATE job_matches \n           SET match_score = ?, matched_at = datetime('now')\n           WHERE id = ?`,\n          [matchScore, existingMatch.id]\n        );\n      } else {\n        // Create new match\n        await execute(env,\n          `INSERT INTO job_matches (job_id, resume_id, candidate_id, match_score, skills_match, experience_match, education_match)\n           VALUES (?, ?, ?, ?, ?, ?, ?)`,\n          [\n            jobId,\n            resume.id,\n            candidate.candidate_id,\n            matchScore,\n            0, // skills_match - calculated separately if needed\n            resume.experience_years || 0,\n            1  // education_match placeholder\n          ]\n        );\n      }\n\n      matched++;\n      matches.push({ candidate_id: candidate.candidate_id, match_score: matchScore });\n    }\n\n    return { matched, matches, message: `Matched ${matched} candidates` };\n  } catch (error) {\n    console.error('Error in auto-match:', error);\n    throw error;\n  }\n}\n\nexport async function handleMatches(request, env, user) {\n  const url = new URL(request.url);\n  const path = url.pathname;\n  const method = request.method;\n\n  // Auto-match candidates to a job based on classification\n  const autoMatchMatch = path.match(/^\\/api\\/matches\\/auto-match\\/(\\d+)$/);\n  if (autoMatchMatch && method === 'POST') {\n    const authError = authorize('consultant', 'admin')(user);\n    if (authError) {\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: authError.error }),\n          { status: authError.status, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n\n    try {\n      const jobId = autoMatchMatch[1];\n      const result = await autoMatchByClassification(env, jobId);\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(result),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error auto-matching:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error', details: error.message }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Get matches for a candidate\n  const candidateMatchesMatch = path.match(/^\\/api\\/matches\\/candidate\\/(\\d+)$/);\n  if (candidateMatchesMatch && method === 'GET') {\n    try {\n      const candidateId = candidateMatchesMatch[1];\n\n      // Verify access\n      if (user.role !== 'admin' && user.role !== 'consultant' && user.id !== parseInt(candidateId)) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Access denied' }),\n            { status: 403, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      const matches = await query(env,\n        `SELECT jm.*, j.title, j.company, j.location, j.employment_type, j.status as job_status\n         FROM job_matches jm\n         INNER JOIN jobs j ON jm.job_id = j.id\n         WHERE jm.candidate_id = ?\n         ORDER BY jm.match_score DESC, jm.matched_at DESC`,\n        [candidateId]\n      );\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(matches),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error fetching matches:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Get matches for a job\n  const jobMatchesMatch = path.match(/^\\/api\\/matches\\/job\\/(\\d+)$/);\n  if (jobMatchesMatch && method === 'GET') {\n    const authError = authorize('consultant', 'admin')(user);\n    if (authError) {\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: authError.error }),\n          { status: authError.status, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n\n    try {\n      const jobId = jobMatchesMatch[1];\n\n      const matches = await query(env,\n        `SELECT jm.*, u.first_name, u.last_name, u.email, cp.current_job_title\n         FROM job_matches jm\n         INNER JOIN users u ON jm.candidate_id = u.id\n         LEFT JOIN candidate_profiles cp ON u.id = cp.user_id\n         WHERE jm.job_id = ?\n         ORDER BY jm.match_score DESC, jm.matched_at DESC`,\n        [jobId]\n      );\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(matches),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error fetching job matches:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Return not implemented for other endpoints\n  return addCorsHeaders(\n    new Response(\n      JSON.stringify({ error: 'Endpoint not implemented' }),\n      { status: 501, headers: { 'Content-Type': 'application/json' } }\n    ),\n    env,\n    request\n  );\n}\n", "/**\n * Authentication routes for Cloudflare Workers\n */\n\nimport { queryOne, execute } from '../utils/db.js';\nimport { addCorsHeaders } from '../utils/cors.js';\n\n/**\n * Hash password using Web Crypto API (PBKDF2)\n */\nasync function hashPassword(password) {\n  const encoder = new TextEncoder();\n  const data = encoder.encode(password);\n  const hashBuffer = await crypto.subtle.digest('SHA-256', data);\n  const hashArray = Array.from(new Uint8Array(hashBuffer));\n  return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');\n}\n\n/**\n * Compare password with hash\n */\nasync function comparePassword(password, hash) {\n  const passwordHash = await hashPassword(password);\n  return passwordHash === hash;\n}\n\n/**\n * Simple JWT creation\n * Note: This is a simplified implementation. For production, use a proper JWT library\n * or implement proper HMAC-SHA256 signing with Web Crypto API\n */\nfunction createJWT(payload, secret, expiresIn = '7d') {\n  const header = { alg: 'HS256', typ: 'JWT' };\n  const now = Math.floor(Date.now() / 1000);\n  const exp = now + (expiresIn === '7d' ? 7 * 24 * 60 * 60 : 60 * 60);\n  \n  const encodedHeader = btoa(JSON.stringify(header)).replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=/g, '');\n  const encodedPayload = btoa(JSON.stringify({ ...payload, exp, iat: now })).replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=/g, '');\n  \n  // Simplified: In production, implement proper HMAC-SHA256 signature\n  // For now, we'll use a simple approach (not secure for production)\n  const signature = btoa(secret).replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=/g, '');\n  return `${encodedHeader}.${encodedPayload}.${signature}`;\n}\n\nexport async function handleAuth(request, env) {\n  const url = new URL(request.url);\n  const path = url.pathname;\n  const method = request.method;\n  \n  // Get origin for CORS\n  const requestOrigin = request.headers.get('Origin');\n\n  // Register\n  if (path === '/api/auth/register' && method === 'POST') {\n    console.log('Registration request received');\n    try {\n      const body = await request.json();\n      console.log('Registration body:', { email: body.email, first_name: body.first_name, last_name: body.last_name, role: body.role });\n      const { email, password, first_name, last_name, role, phone } = body;\n\n      // Check if user exists\n      const existingUser = await queryOne(\n        env,\n        'SELECT id FROM users WHERE email = ?',\n        [email]\n      );\n\n      if (existingUser) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'User already exists' }),\n            { status: 400, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      // Hash password\n      const password_hash = await hashPassword(password);\n\n      // Insert user\n      console.log('Attempting to insert user:', { email, first_name, last_name, role: role || 'candidate' });\n      \n      let result;\n      try {\n        result = await execute(\n          env,\n          `INSERT INTO users (email, password_hash, first_name, last_name, role, phone)\n           VALUES (?, ?, ?, ?, ?, ?)`,\n          [email, password_hash, first_name, last_name, role || 'candidate', phone || null]\n        );\n        console.log('Insert result:', JSON.stringify(result));\n      } catch (dbError) {\n        console.error('Database insert error:', dbError);\n        console.error('Error details:', {\n          message: dbError.message,\n          stack: dbError.stack,\n          name: dbError.name\n        });\n        throw new Error(`Database error: ${dbError.message}`);\n      }\n\n      const userId = result.meta?.last_row_id || result.lastInsertRowid;\n      \n      if (!userId) {\n        console.error('Failed to get last insert ID. Result:', JSON.stringify(result));\n        console.error('Result meta:', result.meta);\n        throw new Error('Failed to create user - no ID returned');\n      }\n      \n      console.log('User created with ID:', userId);\n\n      // Get created user immediately to verify insertion\n      const user = await queryOne(\n        env,\n        'SELECT id, email, first_name, last_name, role FROM users WHERE id = ?',\n        [userId]\n      );\n      \n      if (!user) {\n        console.error('User was not found after insertion. ID:', userId);\n        throw new Error('User was not created successfully');\n      }\n\n      // Create candidate profile if user is a candidate\n      if (user.role === 'candidate') {\n        try {\n          await execute(\n            env,\n            `INSERT INTO candidate_profiles (user_id) VALUES (?)`,\n            [userId]\n          );\n          console.log('Candidate profile created for user ID:', userId);\n        } catch (profileError) {\n          console.error('Error creating candidate profile:', profileError);\n          // Don't fail registration if profile creation fails, but log it\n          // The profile can be created later if needed\n        }\n      }\n\n      // Generate token\n      const token = createJWT(\n        { userId: user.id },\n        env.JWT_SECRET,\n        env.JWT_EXPIRE || '7d'\n      );\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({\n            token,\n            user: {\n              id: user.id,\n              email: user.email,\n              first_name: user.first_name,\n              last_name: user.last_name,\n              role: user.role,\n            },\n          }),\n          {\n            status: 201,\n            headers: { 'Content-Type': 'application/json' },\n          }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Registration error:', error);\n      console.error('Error stack:', error.stack);\n      console.error('Error message:', error.message);\n      console.error('Error name:', error.name);\n      \n      // Return detailed error for debugging\n      const errorMessage = error.message || 'Unknown error';\n      const isDevelopment = env.NODE_ENV === 'development' || !env.NODE_ENV;\n      \n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ \n            error: 'Registration failed',\n            message: isDevelopment ? errorMessage : 'Failed to create user. Please try again.',\n            details: isDevelopment ? {\n              name: error.name,\n              stack: error.stack\n            } : undefined\n          }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Login\n  if (path === '/api/auth/login' && method === 'POST') {\n    try {\n      const body = await request.json();\n      const { email, password } = body;\n\n      // Get user\n      const user = await queryOne(\n        env,\n        'SELECT id, email, password_hash, first_name, last_name, role, is_active FROM users WHERE email = ?',\n        [email]\n      );\n\n      if (!user) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Invalid credentials' }),\n            { status: 401, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      if (!user.is_active) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Account is deactivated' }),\n            { status: 401, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      // Check password\n      const isValid = await comparePassword(password, user.password_hash);\n      if (!isValid) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Invalid credentials' }),\n            { status: 401, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      // Generate token\n      const token = createJWT(\n        { userId: user.id },\n        env.JWT_SECRET,\n        env.JWT_EXPIRE || '7d'\n      );\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({\n            token,\n            user: {\n              id: user.id,\n              email: user.email,\n              first_name: user.first_name,\n              last_name: user.last_name,\n              role: user.role,\n            },\n          }),\n          {\n            status: 200,\n            headers: { 'Content-Type': 'application/json' },\n          }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Login error:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Get current user\n  if (path === '/api/auth/me' && method === 'GET') {\n    const { authenticate } = await import('../middleware/auth.js');\n    const authResult = await authenticate(request, env);\n\n    if (authResult.error) {\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: authResult.error }),\n          {\n            status: authResult.status || 401,\n            headers: { 'Content-Type': 'application/json' },\n          }\n        ),\n        env,\n        request\n      );\n    }\n\n    return addCorsHeaders(\n      new Response(\n        JSON.stringify({ user: authResult.user }),\n        {\n          status: 200,\n          headers: { 'Content-Type': 'application/json' },\n        }\n      ),\n      env,\n      request\n    );\n  }\n\n  return addCorsHeaders(\n    new Response(\n      JSON.stringify({ error: 'Not found' }),\n      { status: 404, headers: { 'Content-Type': 'application/json' } }\n    ),\n    env,\n    request\n  );\n}\n\n", "/**\n * Jobs routes for Cloudflare Workers\n */\n\nimport { query, queryOne, execute } from '../utils/db.js';\nimport { addCorsHeaders } from '../utils/cors.js';\nimport { authorize } from '../middleware/auth.js';\n\nexport async function handleJobs(request, env, user) {\n  const url = new URL(request.url);\n  const path = url.pathname;\n  const method = request.method;\n\n  // Get all jobs\n  if (path === '/api/jobs' && method === 'GET') {\n    try {\n      const { searchParams } = url;\n      const status = searchParams.get('status');\n      const search = searchParams.get('search');\n      const location = searchParams.get('location');\n      const employment_type = searchParams.get('employment_type');\n      const include_deleted = searchParams.get('include_deleted');\n\n      let sql = `SELECT j.*, jr.name as job_classification_name \n                 FROM jobs j \n                 LEFT JOIN job_roles jr ON j.job_classification = jr.id \n                 WHERE 1=1`;\n      const params = [];\n\n      if (include_deleted !== 'true') {\n        sql += \" AND status != 'deleted'\";\n      }\n\n      if (status) {\n        sql += ' AND status = ?';\n        params.push(status);\n      }\n\n      if (search) {\n        sql += ' AND (title LIKE ? OR description LIKE ? OR company LIKE ?)';\n        const searchTerm = `%${search}%`;\n        params.push(searchTerm, searchTerm, searchTerm);\n      }\n\n      if (location) {\n        sql += ' AND location LIKE ?';\n        params.push(`%${location}%`);\n      }\n\n      if (employment_type) {\n        sql += ' AND employment_type = ?';\n        params.push(employment_type);\n      }\n\n      sql += ' ORDER BY created_at DESC';\n\n      const results = await query(env, sql, params);\n\n      // Parse JSON fields\n      const jobs = results.map(job => {\n        if (job.required_skills) {\n          try {\n            job.required_skills = JSON.parse(job.required_skills);\n          } catch (e) {\n            job.required_skills = [];\n          }\n        }\n        if (job.preferred_skills) {\n          try {\n            job.preferred_skills = JSON.parse(job.preferred_skills);\n          } catch (e) {\n            job.preferred_skills = [];\n          }\n        }\n        return job;\n      });\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(jobs),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error fetching jobs:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Get single job\n  const singleJobMatch = path.match(/^\\/api\\/jobs\\/(\\d+)$/);\n  if (singleJobMatch && method === 'GET') {\n    try {\n      const jobId = singleJobMatch[1];\n      const job = await queryOne(env, \n        `SELECT j.*, jr.name as job_classification_name \n         FROM jobs j \n         LEFT JOIN job_roles jr ON j.job_classification = jr.id \n         WHERE j.id = ?`, \n        [jobId]);\n\n      if (!job) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Job not found' }),\n            { status: 404, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      // Parse JSON fields\n      if (job.required_skills) {\n        try {\n          job.required_skills = JSON.parse(job.required_skills);\n        } catch (e) {\n          job.required_skills = [];\n        }\n      }\n      if (job.preferred_skills) {\n        try {\n          job.preferred_skills = JSON.parse(job.preferred_skills);\n        } catch (e) {\n          job.preferred_skills = [];\n        }\n      }\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(job),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error fetching job:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Create job\n  if (path === '/api/jobs' && method === 'POST') {\n    const authError = authorize('consultant', 'admin')(user);\n    if (authError) {\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: authError.error }),\n          { status: authError.status, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n\n    try {\n      const body = await request.json();\n      const {\n        title, job_classification, description, company, location, salary_min, salary_max,\n        employment_type, required_skills, preferred_skills, experience_level,\n        external_apply_link, status,\n      } = body;\n\n      const result = await execute(\n        env,\n        `INSERT INTO jobs (title, job_classification, description, company, location, salary_min, salary_max,\n         employment_type, required_skills, preferred_skills, experience_level, external_apply_link, status, posted_by)\n         VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,\n        [\n          title, job_classification || null, description, company, location, salary_min, salary_max,\n          employment_type,\n          required_skills ? JSON.stringify(required_skills) : '[]',\n          preferred_skills ? JSON.stringify(preferred_skills) : '[]',\n          experience_level, external_apply_link || null,\n          status || 'active', user.id,\n        ]\n      );\n\n      const jobId = result.meta.last_row_id;\n      const job = await queryOne(env, \n        `SELECT j.*, jr.name as job_classification_name \n         FROM jobs j \n         LEFT JOIN job_roles jr ON j.job_classification = jr.id \n         WHERE j.id = ?`, \n        [jobId]);\n\n      // Parse JSON fields\n      if (job.required_skills) {\n        try {\n          job.required_skills = JSON.parse(job.required_skills);\n        } catch (e) {\n          job.required_skills = [];\n        }\n      }\n      if (job.preferred_skills) {\n        try {\n          job.preferred_skills = JSON.parse(job.preferred_skills);\n        } catch (e) {\n          job.preferred_skills = [];\n        }\n      }\n\n      // Auto-match candidates if job has classification\n      if (job_classification) {\n        try {\n          const { autoMatchByClassification } = await import('./matches.js');\n          await autoMatchByClassification(env, jobId);\n        } catch (e) {\n          console.error('Error auto-matching candidates:', e);\n          // Don't fail the job creation if matching fails\n        }\n      }\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(job),\n          { status: 201, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error creating job:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Update job\n  if (singleJobMatch && method === 'PUT') {\n    const authError = authorize('consultant', 'admin')(user);\n    if (authError) {\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: authError.error }),\n          { status: authError.status, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n\n    try {\n      const jobId = singleJobMatch[1];\n      const body = await request.json();\n      const {\n        title, job_classification, description, company, location, salary_min, salary_max,\n        employment_type, required_skills, preferred_skills, experience_level,\n        external_apply_link, status,\n      } = body;\n\n      await execute(\n        env,\n        `UPDATE jobs SET title = ?, job_classification = ?, description = ?, company = ?, location = ?,\n         salary_min = ?, salary_max = ?, employment_type = ?, required_skills = ?,\n         preferred_skills = ?, experience_level = ?, external_apply_link = ?, status = ?, updated_at = datetime('now')\n         WHERE id = ?`,\n        [\n          title, job_classification || null, description, company, location, salary_min, salary_max,\n          employment_type,\n          required_skills ? JSON.stringify(required_skills) : '[]',\n          preferred_skills ? JSON.stringify(preferred_skills) : '[]',\n          experience_level, external_apply_link || null, status, jobId,\n        ]\n      );\n\n      const job = await queryOne(env, \n        `SELECT j.*, jr.name as job_classification_name \n         FROM jobs j \n         LEFT JOIN job_roles jr ON j.job_classification = jr.id \n         WHERE j.id = ?`, \n        [jobId]);\n\n      if (!job) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Job not found' }),\n            { status: 404, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      // Parse JSON fields\n      if (job.required_skills) {\n        try {\n          job.required_skills = JSON.parse(job.required_skills);\n        } catch (e) {\n          job.required_skills = [];\n        }\n      }\n      if (job.preferred_skills) {\n        try {\n          job.preferred_skills = JSON.parse(job.preferred_skills);\n        } catch (e) {\n          job.preferred_skills = [];\n        }\n      }\n\n      // Auto-match candidates if job classification was updated\n      if (job_classification) {\n        try {\n          const { autoMatchByClassification } = await import('./matches.js');\n          await autoMatchByClassification(env, jobId);\n        } catch (e) {\n          console.error('Error auto-matching candidates:', e);\n          // Don't fail the job update if matching fails\n        }\n      }\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(job),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error updating job:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Delete job\n  if (singleJobMatch && method === 'DELETE') {\n    const authError = authorize('consultant', 'admin')(user);\n    if (authError) {\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: authError.error }),\n          { status: authError.status, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n\n    try {\n      const jobId = singleJobMatch[1];\n      await execute(\n        env,\n        \"UPDATE jobs SET status = 'deleted', updated_at = datetime('now') WHERE id = ?\",\n        [jobId]\n      );\n\n      const job = await queryOne(env, 'SELECT id, status FROM jobs WHERE id = ?', [jobId]);\n\n      if (!job) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Job not found' }),\n            { status: 404, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ message: 'Job deleted successfully', job }),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error deleting job:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  return addCorsHeaders(\n    new Response(\n      JSON.stringify({ error: 'Not found' }),\n      { status: 404, headers: { 'Content-Type': 'application/json' } }\n    ),\n    env,\n    request\n  );\n}\n\n", "/**\n * Resume routes for Cloudflare Workers with R2 storage\n */\n\nimport { query, queryOne, execute } from '../utils/db.js';\nimport { addCorsHeaders } from '../utils/cors.js';\nimport { authorize } from '../middleware/auth.js';\n\n/**\n * Upload file to R2\n */\nasync function uploadToR2(env, file, userId, originalName) {\n  const timestamp = Date.now();\n  const randomSuffix = Math.round(Math.random() * 1e9);\n  const ext = originalName.split('.').pop();\n  const key = `resumes/resume-${userId}-${timestamp}-${randomSuffix}.${ext}`;\n\n  // Upload to R2\n  await env.R2_BUCKET.put(key, file, {\n    httpMetadata: {\n      contentType: file.type || 'application/octet-stream',\n    },\n    customMetadata: {\n      originalName,\n      userId: userId.toString(),\n      uploadedAt: new Date().toISOString(),\n    },\n  });\n\n  return key;\n}\n\n/**\n * Get file from R2\n */\nasync function getFromR2(env, key) {\n  const object = await env.R2_BUCKET.get(key);\n  if (!object) {\n    return null;\n  }\n  return object;\n}\n\n/**\n * Delete file from R2\n */\nasync function deleteFromR2(env, key) {\n  await env.R2_BUCKET.delete(key);\n}\n\nexport async function handleResumes(request, env, user) {\n  const url = new URL(request.url);\n  const path = url.pathname;\n  const method = request.method;\n\n  // Upload resume\n  if (path === '/api/resumes/upload' && method === 'POST') {\n    try {\n      const formData = await request.formData();\n      const file = formData.get('resume');\n\n      if (!file) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'No file uploaded' }),\n            { status: 400, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      // Validate file type\n      const allowedTypes = ['.pdf', '.doc', '.docx'];\n      const ext = '.' + file.name.split('.').pop().toLowerCase();\n      if (!allowedTypes.includes(ext)) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Invalid file type. Only PDF, DOC, and DOCX are allowed.' }),\n            { status: 400, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      // Validate file size (5MB)\n      if (file.size > 5 * 1024 * 1024) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'File size exceeds 5MB limit' }),\n            { status: 400, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      const skills = formData.get('skills');\n      const experience_years = formData.get('experience_years');\n      const education = formData.get('education');\n      const summary = formData.get('summary');\n\n      // Upload to R2\n      const fileBuffer = await file.arrayBuffer();\n      const r2Key = await uploadToR2(env, fileBuffer, user.id, file.name);\n\n      // Store in database\n      const result = await execute(\n        env,\n        `INSERT INTO resumes (user_id, file_path, file_name, file_size, content_text, skills, experience_years, education, summary)\n         VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)`,\n        [\n          user.id,\n          r2Key,\n          file.name,\n          file.size,\n          '', // content_text would be extracted from file\n          skills ? JSON.stringify(JSON.parse(skills)) : '[]',\n          experience_years ? parseInt(experience_years) : null,\n          education || '',\n          summary || '',\n        ]\n      );\n\n      const resumeId = result.meta.last_row_id;\n      const resume = await queryOne(\n        env,\n        'SELECT * FROM resumes WHERE id = ?',\n        [resumeId]\n      );\n\n      // Parse JSON fields\n      if (resume.skills) {\n        try {\n          resume.skills = JSON.parse(resume.skills);\n        } catch (e) {\n          resume.skills = [];\n        }\n      }\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(resume),\n          { status: 201, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error uploading resume:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Get user's resumes\n  if (path === '/api/resumes/my-resumes' && method === 'GET') {\n    try {\n      const results = await query(\n        env,\n        'SELECT * FROM resumes WHERE user_id = ? ORDER BY uploaded_at DESC',\n        [user.id]\n      );\n\n      // Parse JSON fields\n      const resumes = results.map(resume => {\n        if (resume.skills) {\n          try {\n            resume.skills = JSON.parse(resume.skills);\n          } catch (e) {\n            resume.skills = [];\n          }\n        }\n        return resume;\n      });\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(resumes),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error fetching resumes:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Get all resumes (consultant/admin only)\n  if (path === '/api/resumes' && method === 'GET') {\n    const authError = authorize('consultant', 'admin')(user);\n    if (authError) {\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: authError.error }),\n          { status: authError.status, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n\n    try {\n      const results = await query(\n        env,\n        `SELECT r.*, u.first_name, u.last_name, u.email \n         FROM resumes r \n         JOIN users u ON r.user_id = u.id \n         ORDER BY r.uploaded_at DESC`\n      );\n\n      // Parse JSON fields\n      const resumes = results.map(resume => {\n        if (resume.skills) {\n          try {\n            resume.skills = JSON.parse(resume.skills);\n          } catch (e) {\n            resume.skills = [];\n          }\n        }\n        return resume;\n      });\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(resumes),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error fetching resumes:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Get single resume\n  const singleResumeMatch = path.match(/^\\/api\\/resumes\\/(\\d+)$/);\n  if (singleResumeMatch && method === 'GET') {\n    try {\n      const resumeId = singleResumeMatch[1];\n      const resume = await queryOne(\n        env,\n        `SELECT r.*, u.first_name, u.last_name, u.email \n         FROM resumes r \n         JOIN users u ON r.user_id = u.id \n         WHERE r.id = ?`,\n        [resumeId]\n      );\n\n      if (!resume) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Resume not found' }),\n            { status: 404, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      // Check permissions\n      if (user.role === 'candidate' && resume.user_id !== user.id) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Access denied' }),\n            { status: 403, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      // Parse JSON fields\n      if (resume.skills) {\n        try {\n          resume.skills = JSON.parse(resume.skills);\n        } catch (e) {\n          resume.skills = [];\n        }\n      }\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(resume),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error fetching resume:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Download resume file\n  const downloadMatch = path.match(/^\\/api\\/resumes\\/(\\d+)\\/download$/);\n  if (downloadMatch && method === 'GET') {\n    try {\n      const resumeId = downloadMatch[1];\n      const resume = await queryOne(\n        env,\n        'SELECT * FROM resumes WHERE id = ?',\n        [resumeId]\n      );\n\n      if (!resume) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Resume not found' }),\n            { status: 404, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      // Check permissions\n      if (user.role === 'candidate' && resume.user_id !== user.id) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Access denied' }),\n            { status: 403, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      // Get file from R2\n      const fileObject = await getFromR2(env, resume.file_path);\n      if (!fileObject) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'File not found' }),\n            { status: 404, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      const fileData = await fileObject.arrayBuffer();\n      const headers = new Headers();\n      headers.set('Content-Type', fileObject.httpMetadata?.contentType || 'application/octet-stream');\n      headers.set('Content-Disposition', `attachment; filename=\"${resume.file_name}\"`);\n\n      return addCorsHeaders(\n        new Response(fileData, {\n          status: 200,\n          headers,\n        }),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error downloading resume:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Update resume\n  if (singleResumeMatch && method === 'PUT') {\n    try {\n      const resumeId = singleResumeMatch[1];\n      const body = await request.json();\n      const { skills, experience_years, education, summary } = body;\n\n      // Check ownership\n      const resumeCheck = await queryOne(\n        env,\n        'SELECT user_id FROM resumes WHERE id = ?',\n        [resumeId]\n      );\n\n      if (!resumeCheck) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Resume not found' }),\n            { status: 404, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      if (resumeCheck.user_id !== user.id && user.role !== 'admin') {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Access denied' }),\n            { status: 403, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      await execute(\n        env,\n        `UPDATE resumes SET skills = ?, experience_years = ?, education = ?, summary = ?, updated_at = datetime('now')\n         WHERE id = ?`,\n        [\n          skills ? JSON.stringify(skills) : '[]',\n          experience_years,\n          education,\n          summary,\n          resumeId,\n        ]\n      );\n\n      const updatedResume = await queryOne(\n        env,\n        'SELECT * FROM resumes WHERE id = ?',\n        [resumeId]\n      );\n\n      // Parse JSON fields\n      if (updatedResume.skills) {\n        try {\n          updatedResume.skills = JSON.parse(updatedResume.skills);\n        } catch (e) {\n          updatedResume.skills = [];\n        }\n      }\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(updatedResume),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error updating resume:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Delete resume\n  if (singleResumeMatch && method === 'DELETE') {\n    try {\n      const resumeId = singleResumeMatch[1];\n      const resumeCheck = await queryOne(\n        env,\n        'SELECT user_id, file_path FROM resumes WHERE id = ?',\n        [resumeId]\n      );\n\n      if (!resumeCheck) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Resume not found' }),\n            { status: 404, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      if (resumeCheck.user_id !== user.id && user.role !== 'admin') {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Access denied' }),\n            { status: 403, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      // Delete from R2\n      if (resumeCheck.file_path) {\n        await deleteFromR2(env, resumeCheck.file_path);\n      }\n\n      // Delete from database\n      await execute(env, 'DELETE FROM resumes WHERE id = ?', [resumeId]);\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ message: 'Resume deleted successfully' }),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error deleting resume:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  return addCorsHeaders(\n    new Response(\n      JSON.stringify({ error: 'Not found' }),\n      { status: 404, headers: { 'Content-Type': 'application/json' } }\n    ),\n    env,\n    request\n  );\n}\n\n", "/**\n * Main router for Cloudflare Workers\n */\n\nimport { handleAuth } from './routes/auth.js';\nimport { handleJobs } from './routes/jobs.js';\nimport { handleResumes } from './routes/resumes.js';\nimport { handleMatches } from './routes/matches.js';\nimport { handleCandidates } from './routes/candidates.js';\nimport { handleCandidateProfiles } from './routes/candidateProfiles.js';\nimport { handleTimesheets } from './routes/timesheets.js';\nimport { handleKPIs } from './routes/kpis.js';\nimport { handleUsers } from './routes/users.js';\nimport { handleGroups } from './routes/groups.js';\nimport { handlePermissions } from './routes/permissions.js';\nimport { handleCRM } from './routes/crm.js';\nimport { handleActivityLogs } from './routes/activityLogs.js';\nimport { handleJobRoles } from './routes/jobRoles.js';\nimport { authenticate } from './middleware/auth.js';\nimport { getCorsHeaders, handleCORS, addCorsHeaders } from './utils/cors.js';\n\nexport async function handleRequest(request, env, ctx) {\n  const url = new URL(request.url);\n  const path = url.pathname;\n  const method = request.method;\n  \n  // Get request origin for CORS\n  const requestOrigin = request.headers.get('Origin');\n\n  // Handle CORS preflight\n  if (method === 'OPTIONS') {\n    return handleCORS(env, request);\n  }\n\n  const corsHeaders = getCorsHeaders(env, requestOrigin);\n\n  // API root - return available endpoints\n  if (path === '/api' || path === '/api/') {\n    return new Response(\n      JSON.stringify({ \n        status: 'OK', \n        message: 'API is running',\n        endpoints: {\n          health: '/api/health',\n          register: '/api/auth/register',\n          login: '/api/auth/login',\n          me: '/api/auth/me'\n        }\n      }),\n      {\n        status: 200,\n        headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n      }\n    );\n  }\n\n  // Health check\n  if (path === '/api/health') {\n    return new Response(\n      JSON.stringify({ status: 'OK', message: 'Server is running' }),\n      {\n        status: 200,\n        headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n      }\n    );\n  }\n\n  // Database test endpoint (for debugging)\n  if (path === '/api/health/db' && method === 'GET') {\n    try {\n      const { query } = await import('./utils/db.js');\n      const tables = await query(env, \"SELECT name FROM sqlite_master WHERE type='table'\");\n      const userCount = await query(env, 'SELECT COUNT(*) as count FROM users');\n      return new Response(\n        JSON.stringify({ \n          status: 'OK', \n          tables: tables.map(t => t.name),\n          userCount: userCount[0]?.count || 0,\n          dbConnected: true\n        }),\n        {\n          status: 200,\n          headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n        }\n      );\n    } catch (error) {\n      return new Response(\n        JSON.stringify({ \n          status: 'ERROR', \n          error: error.message,\n          dbConnected: false\n        }),\n        {\n          status: 500,\n          headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n        }\n      );\n    }\n  }\n\n  // Route handlers\n  try {\n    // Auth routes (no authentication required)\n    if (path.startsWith('/api/auth')) {\n      console.log('Handling auth route:', path, method);\n      try {\n        const response = await handleAuth(request, env);\n        if (response) {\n          return addCorsHeaders(response, env, request);\n        }\n        // If handleAuth returns null/undefined, return 404\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Auth endpoint not found' }),\n            { status: 404, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      } catch (authError) {\n        console.error('Error in handleAuth:', authError);\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Auth handler error', message: authError.message }),\n            { status: 500, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n    }\n\n    // All other routes require authentication\n    const authResult = await authenticate(request, env);\n    if (authResult.error) {\n      console.log('Authentication failed:', authResult.error, 'for path:', path);\n      return new Response(\n        JSON.stringify({ error: authResult.error }),\n        {\n          status: authResult.status || 401,\n          headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n        }\n      );\n    }\n\n    // Attach user to request context\n    const user = authResult.user;\n\n    // Route to appropriate handler\n    let response;\n    if (path.startsWith('/api/jobs')) {\n      response = await handleJobs(request, env, user);\n    } else if (path.startsWith('/api/resumes')) {\n      response = await handleResumes(request, env, user);\n    } else if (path.startsWith('/api/matches')) {\n      response = await handleMatches(request, env, user);\n    } else if (path.startsWith('/api/candidates')) {\n      response = await handleCandidates(request, env, user);\n    } else if (path.startsWith('/api/candidate-profiles')) {\n      response = await handleCandidateProfiles(request, env, user);\n    } else if (path.startsWith('/api/timesheets')) {\n      response = await handleTimesheets(request, env, user);\n    } else if (path.startsWith('/api/kpis')) {\n      response = await handleKPIs(request, env, user);\n    } else if (path.startsWith('/api/users')) {\n      response = await handleUsers(request, env, user);\n    } else if (path.startsWith('/api/groups')) {\n      response = await handleGroups(request, env, user);\n    } else if (path.startsWith('/api/permissions')) {\n      response = await handlePermissions(request, env, user);\n    } else if (path.startsWith('/api/crm')) {\n      response = await handleCRM(request, env, user);\n    } else if (path.startsWith('/api/activity-logs')) {\n      response = await handleActivityLogs(request, env, user);\n    } else if (path.startsWith('/api/job-roles')) {\n      response = await handleJobRoles(request, env, user);\n    } else {\n      response = new Response(\n        JSON.stringify({ error: 'Not found' }),\n        {\n          status: 404,\n          headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n        }\n      );\n    }\n    \n    return addCorsHeaders(response, env, request);\n  } catch (error) {\n    console.error('Route handler error:', error);\n    return new Response(\n      JSON.stringify({ error: 'Internal server error', message: error.message }),\n      {\n        status: 500,\n        headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n      }\n    );\n  }\n}\n\n", "/**\n * Candidates routes for Cloudflare Workers\n */\n\nimport { query, queryOne, execute } from '../utils/db.js';\nimport { addCorsHeaders } from '../utils/cors.js';\nimport { authorize } from '../middleware/auth.js';\n\n// Field mapping: frontend field name -> database column\nconst fieldMapping = {\n  'first_name': { table: 'u', column: 'first_name', type: 'text' },\n  'last_name': { table: 'u', column: 'last_name', type: 'text' },\n  'email': { table: 'u', column: 'email', type: 'text' },\n  'phone': { table: 'u', column: 'phone', type: 'text' },\n  'city': { table: 'cp', column: 'city', type: 'text' },\n  'state': { table: 'cp', column: 'state', type: 'text' },\n  'country': { table: 'cp', column: 'country', type: 'text' },\n  'current_job_title': { table: 'cp', column: 'current_job_title', type: 'text' },\n  'secondary_job_title': { table: 'cp', column: 'secondary_job_title', type: 'text' },\n  'current_company': { table: 'cp', column: 'current_company', type: 'text' },\n  'years_of_experience': { table: 'cp', column: 'years_of_experience', type: 'number' },\n  'availability': { table: 'cp', column: 'availability', type: 'text' },\n  'work_authorization': { table: 'cp', column: 'work_authorization', type: 'text' },\n  'willing_to_relocate': { table: 'cp', column: 'willing_to_relocate', type: 'boolean' },\n  'is_active': { table: 'u', column: 'is_active', type: 'boolean' },\n};\n\n// Build WHERE conditions from filter conditions\nexport function buildFilterConditions(filterConditions, baseTable = 'u') {\n  const whereConditions = [];\n  const params = [];\n  \n  if (!filterConditions || !Array.isArray(filterConditions)) {\n    return { whereConditions, params };\n  }\n  \n  for (const condition of filterConditions) {\n    if (!condition.field || !condition.value) continue;\n    \n    const fieldMap = fieldMapping[condition.field];\n    if (!fieldMap) continue;\n    \n    const { table, column, type } = fieldMap;\n    const operator = condition.operator || 'like';\n    const value = condition.value.trim();\n    \n    if (!value) continue;\n    \n    let sqlCondition = '';\n    let paramValue = value;\n    \n    if (type === 'boolean') {\n      // Boolean fields\n      if (value === 'true' || value === '1') {\n        sqlCondition = `${table}.${column} = 1`;\n      } else if (value === 'false' || value === '0') {\n        sqlCondition = `(${table}.${column} = 0 OR ${table}.${column} IS NULL)`;\n      }\n    } else if (type === 'number') {\n      // Numeric fields with comparison operators\n      const numValue = parseFloat(value);\n      if (isNaN(numValue)) continue;\n      \n      if (operator === '=' || operator === '==') {\n        sqlCondition = `(${table}.${column} IS NOT NULL AND ${table}.${column} = ?)`;\n        params.push(numValue);\n      } else if (operator === '>') {\n        sqlCondition = `(${table}.${column} IS NOT NULL AND ${table}.${column} > ?)`;\n        params.push(numValue);\n      } else if (operator === '<') {\n        sqlCondition = `(${table}.${column} IS NOT NULL AND ${table}.${column} < ?)`;\n        params.push(numValue);\n      } else if (operator === '>=') {\n        sqlCondition = `(${table}.${column} IS NOT NULL AND ${table}.${column} >= ?)`;\n        params.push(numValue);\n      } else if (operator === '<=') {\n        sqlCondition = `(${table}.${column} IS NOT NULL AND ${table}.${column} <= ?)`;\n        params.push(numValue);\n      }\n    } else {\n      // Text fields\n      if (operator === '=' || operator === '==') {\n        sqlCondition = `${table}.${column} = ?`;\n        params.push(value);\n      } else if (operator === 'like') {\n        // Handle LIKE patterns - if value doesn't have %, add % around it\n        let likeValue = value;\n        if (!likeValue.includes('%')) {\n          likeValue = `%${likeValue}%`;\n        }\n        sqlCondition = `(${table}.${column} IS NOT NULL AND ${table}.${column} LIKE ?)`;\n        params.push(likeValue);\n      }\n    }\n    \n    if (sqlCondition) {\n      whereConditions.push(sqlCondition);\n    }\n  }\n  \n  return { whereConditions, params };\n}\n\nexport async function handleCandidates(request, env, user) {\n  const url = new URL(request.url);\n  const path = url.pathname;\n  const method = request.method;\n\n  // Get assigned candidates (for consultants)\n  if (path === '/api/candidates/assigned' && method === 'GET') {\n    const authCheck = authorize('consultant', 'admin')(user);\n    if (authCheck) {\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: authCheck.error }),\n          { status: authCheck.status || 403, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n\n    try {\n      const { searchParams } = url;\n      \n      // Build WHERE clause with filters\n      let whereConditions = ['ca.consultant_id = ?'];\n      const params = [user.id];\n\n      // Handle dynamic filter conditions\n      const queryParam = searchParams.get('query');\n      if (queryParam) {\n        try {\n          const filterConditions = JSON.parse(decodeURIComponent(queryParam));\n          const { whereConditions: filterWhere, params: filterParams } = buildFilterConditions(filterConditions);\n          whereConditions.push(...filterWhere);\n          params.push(...filterParams);\n        } catch (e) {\n          console.error('Error parsing filter conditions:', e);\n        }\n      }\n\n      // Legacy filter support (for backward compatibility)\n      const search = searchParams.get('search');\n      if (search) {\n        whereConditions.push('(u.first_name LIKE ? OR u.last_name LIKE ? OR u.email LIKE ? OR (cp.current_company IS NOT NULL AND cp.current_company LIKE ?))');\n        const searchTerm = `%${search}%`;\n        params.push(searchTerm, searchTerm, searchTerm, searchTerm);\n      }\n\n      const city = searchParams.get('city');\n      if (city) {\n        whereConditions.push('(cp.city IS NOT NULL AND cp.city LIKE ?)');\n        params.push(`%${city}%`);\n      }\n\n      const state = searchParams.get('state');\n      if (state) {\n        whereConditions.push('(cp.state IS NOT NULL AND cp.state LIKE ?)');\n        params.push(`%${state}%`);\n      }\n\n      const country = searchParams.get('country');\n      if (country) {\n        whereConditions.push('(cp.country IS NOT NULL AND cp.country LIKE ?)');\n        params.push(`%${country}%`);\n      }\n\n      const current_job_title = searchParams.get('current_job_title');\n      if (current_job_title) {\n        whereConditions.push('(cp.current_job_title IS NOT NULL AND cp.current_job_title LIKE ?)');\n        params.push(`%${current_job_title}%`);\n      }\n\n      const current_company = searchParams.get('current_company');\n      if (current_company) {\n        whereConditions.push('(cp.current_company IS NOT NULL AND cp.current_company LIKE ?)');\n        params.push(`%${current_company}%`);\n      }\n\n      const years_min = searchParams.get('years_of_experience_min');\n      if (years_min) {\n        whereConditions.push('(cp.years_of_experience IS NOT NULL AND cp.years_of_experience >= ?)');\n        params.push(parseInt(years_min));\n      }\n\n      const years_max = searchParams.get('years_of_experience_max');\n      if (years_max) {\n        whereConditions.push('(cp.years_of_experience IS NOT NULL AND cp.years_of_experience <= ?)');\n        params.push(parseInt(years_max));\n      }\n\n      const availability = searchParams.get('availability');\n      if (availability) {\n        whereConditions.push('(cp.availability IS NOT NULL AND cp.availability = ?)');\n        params.push(availability);\n      }\n\n      const work_authorization = searchParams.get('work_authorization');\n      if (work_authorization) {\n        whereConditions.push('(cp.work_authorization IS NOT NULL AND cp.work_authorization LIKE ?)');\n        params.push(`%${work_authorization}%`);\n      }\n\n      const willing_to_relocate = searchParams.get('willing_to_relocate');\n      if (willing_to_relocate === 'true') {\n        whereConditions.push('cp.willing_to_relocate = 1');\n      } else if (willing_to_relocate === 'false') {\n        whereConditions.push('(cp.willing_to_relocate = 0 OR cp.willing_to_relocate IS NULL)');\n      }\n\n      const has_resume = searchParams.get('has_resume');\n      if (has_resume === 'true') {\n        whereConditions.push('(SELECT COUNT(*) FROM resumes r WHERE r.user_id = u.id) > 0');\n      } else if (has_resume === 'false') {\n        whereConditions.push('(SELECT COUNT(*) FROM resumes r WHERE r.user_id = u.id) = 0');\n      }\n\n      const has_matches = searchParams.get('has_matches');\n      if (has_matches === 'true') {\n        whereConditions.push('(SELECT COUNT(*) FROM job_matches jm WHERE jm.candidate_id = u.id) > 0');\n      } else if (has_matches === 'false') {\n        whereConditions.push('(SELECT COUNT(*) FROM job_matches jm WHERE jm.candidate_id = u.id) = 0');\n      }\n\n      const whereClause = whereConditions.join(' AND ');\n      console.log('Assigned candidates SQL WHERE clause:', whereClause);\n      console.log('Assigned candidates SQL params:', params);\n\n      const candidates = await query(\n        env,\n        `SELECT \n          u.id, \n          u.first_name, \n          u.last_name, \n          u.email, \n          u.phone, \n          u.created_at,\n          ca.assigned_at, \n          ca.status as assignment_status,\n          (SELECT COUNT(*) FROM resumes r WHERE r.user_id = u.id) as resume_count,\n          (SELECT COUNT(*) FROM job_matches jm WHERE jm.candidate_id = u.id) as match_count,\n          cp.current_job_title, \n          cp.current_company, \n          cp.years_of_experience, \n          cp.availability\n        FROM consultant_assignments ca\n        JOIN users u ON ca.candidate_id = u.id\n        LEFT JOIN candidate_profiles cp ON u.id = cp.user_id\n        WHERE ${whereClause}\n        ORDER BY ca.assigned_at DESC`,\n        params\n      );\n\n      console.log('Assigned candidates query result count:', candidates?.length || 0);\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(candidates || []),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error fetching assigned candidates:', error);\n      console.error('Error stack:', error.stack);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error', details: error.message }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Get all candidates (admin only)\n  if (path === '/api/candidates' && method === 'GET') {\n    const authCheck = authorize('admin')(user);\n    if (authCheck) {\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: authCheck.error }),\n          { status: authCheck.status || 403, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n\n    try {\n      const { searchParams } = url;\n      \n      console.log('Candidates filter params:', Array.from(searchParams.entries()));\n      \n      // Build WHERE clause with filters\n      let whereConditions = [\"u.role = 'candidate'\"];\n      const params = [];\n\n      // Handle dynamic filter conditions\n      const queryParam = searchParams.get('query');\n      if (queryParam) {\n        try {\n          const filterConditions = JSON.parse(decodeURIComponent(queryParam));\n          const { whereConditions: filterWhere, params: filterParams } = buildFilterConditions(filterConditions);\n          whereConditions.push(...filterWhere);\n          params.push(...filterParams);\n        } catch (e) {\n          console.error('Error parsing filter conditions:', e);\n        }\n      }\n\n      // Legacy filter support (for backward compatibility)\n      const search = searchParams.get('search');\n      if (search) {\n        whereConditions.push('(u.first_name LIKE ? OR u.last_name LIKE ? OR u.email LIKE ? OR (cp.current_company IS NOT NULL AND cp.current_company LIKE ?))');\n        const searchTerm = `%${search}%`;\n        params.push(searchTerm, searchTerm, searchTerm, searchTerm);\n      }\n\n      // Location filters (handle NULL profiles)\n      const city = searchParams.get('city');\n      if (city) {\n        whereConditions.push('(cp.city IS NOT NULL AND cp.city LIKE ?)');\n        params.push(`%${city}%`);\n      }\n\n      const state = searchParams.get('state');\n      if (state) {\n        whereConditions.push('(cp.state IS NOT NULL AND cp.state LIKE ?)');\n        params.push(`%${state}%`);\n      }\n\n      const country = searchParams.get('country');\n      if (country) {\n        whereConditions.push('(cp.country IS NOT NULL AND cp.country LIKE ?)');\n        params.push(`%${country}%`);\n      }\n\n      // Job filters\n      const current_job_title = searchParams.get('current_job_title');\n      if (current_job_title) {\n        whereConditions.push('(cp.current_job_title IS NOT NULL AND cp.current_job_title LIKE ?)');\n        params.push(`%${current_job_title}%`);\n      }\n\n      const current_company = searchParams.get('current_company');\n      if (current_company) {\n        whereConditions.push('(cp.current_company IS NOT NULL AND cp.current_company LIKE ?)');\n        params.push(`%${current_company}%`);\n      }\n\n      // Experience filters\n      const years_min = searchParams.get('years_of_experience_min');\n      if (years_min) {\n        whereConditions.push('(cp.years_of_experience IS NOT NULL AND cp.years_of_experience >= ?)');\n        params.push(parseInt(years_min));\n      }\n\n      const years_max = searchParams.get('years_of_experience_max');\n      if (years_max) {\n        whereConditions.push('(cp.years_of_experience IS NOT NULL AND cp.years_of_experience <= ?)');\n        params.push(parseInt(years_max));\n      }\n\n      // Availability\n      const availability = searchParams.get('availability');\n      if (availability) {\n        whereConditions.push('(cp.availability IS NOT NULL AND cp.availability = ?)');\n        params.push(availability);\n      }\n\n      // Work authorization\n      const work_authorization = searchParams.get('work_authorization');\n      if (work_authorization) {\n        whereConditions.push('(cp.work_authorization IS NOT NULL AND cp.work_authorization LIKE ?)');\n        params.push(`%${work_authorization}%`);\n      }\n\n      // Willing to relocate\n      const willing_to_relocate = searchParams.get('willing_to_relocate');\n      if (willing_to_relocate === 'true') {\n        whereConditions.push('cp.willing_to_relocate = 1');\n      } else if (willing_to_relocate === 'false') {\n        whereConditions.push('(cp.willing_to_relocate = 0 OR cp.willing_to_relocate IS NULL)');\n      }\n\n      // Has resume\n      const has_resume = searchParams.get('has_resume');\n      if (has_resume === 'true') {\n        whereConditions.push('(SELECT COUNT(*) FROM resumes r WHERE r.user_id = u.id) > 0');\n      } else if (has_resume === 'false') {\n        whereConditions.push('(SELECT COUNT(*) FROM resumes r WHERE r.user_id = u.id) = 0');\n      }\n\n      // Has matches\n      const has_matches = searchParams.get('has_matches');\n      if (has_matches === 'true') {\n        whereConditions.push('(SELECT COUNT(*) FROM job_matches jm WHERE jm.candidate_id = u.id) > 0');\n      } else if (has_matches === 'false') {\n        whereConditions.push('(SELECT COUNT(*) FROM job_matches jm WHERE jm.candidate_id = u.id) = 0');\n      }\n\n      // Active status\n      const is_active = searchParams.get('is_active');\n      if (is_active === 'true') {\n        whereConditions.push('u.is_active = 1');\n      } else if (is_active === 'false') {\n        whereConditions.push('u.is_active = 0');\n      }\n\n      const whereClause = whereConditions.join(' AND ');\n      console.log('SQL WHERE clause:', whereClause);\n      console.log('SQL params:', params);\n\n      const candidates = await query(\n        env,\n        `SELECT \n          u.id, \n          u.first_name, \n          u.last_name, \n          u.email, \n          u.phone, \n          u.role, \n          u.is_active, \n          u.created_at,\n          (SELECT COUNT(*) FROM resumes r WHERE r.user_id = u.id) as resume_count,\n          (SELECT COUNT(*) FROM job_matches jm WHERE jm.candidate_id = u.id) as match_count,\n          cp.current_job_title, \n          cp.current_company, \n          cp.years_of_experience, \n          cp.availability\n        FROM users u\n        LEFT JOIN candidate_profiles cp ON u.id = cp.user_id\n        WHERE ${whereClause}\n        ORDER BY u.created_at DESC`,\n        params\n      );\n\n      console.log('Candidates query result count:', candidates?.length || 0);\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(candidates || []),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error fetching candidates:', error);\n      console.error('Error stack:', error.stack);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error', details: error.message }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Get candidate details\n  const candidateDetailMatch = path.match(/^\\/api\\/candidates\\/(\\d+)$/);\n  if (candidateDetailMatch && method === 'GET') {\n    const candidateId = candidateDetailMatch[1];\n    const authCheck = authorize('consultant', 'admin')(user);\n    if (authCheck) {\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: authCheck.error }),\n          { status: authCheck.status || 403, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n\n    try {\n      // Check if consultant has access to this candidate\n      if (user.role === 'consultant') {\n        const assignmentCheck = await queryOne(\n          env,\n          'SELECT id FROM consultant_assignments WHERE consultant_id = ? AND candidate_id = ?',\n          [user.id, candidateId]\n        );\n        if (!assignmentCheck) {\n          return addCorsHeaders(\n            new Response(\n              JSON.stringify({ error: 'Access denied' }),\n              { status: 403, headers: { 'Content-Type': 'application/json' } }\n            ),\n            env,\n            request\n          );\n        }\n      }\n\n      const candidate = await queryOne(\n        env,\n        'SELECT id, first_name, last_name, email, phone, created_at FROM users WHERE id = ? AND role = ?',\n        [candidateId, 'candidate']\n      );\n\n      if (!candidate) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Candidate not found' }),\n            { status: 404, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      // Get resumes\n      const resumes = await query(\n        env,\n        'SELECT * FROM resumes WHERE user_id = ? ORDER BY uploaded_at DESC',\n        [candidateId]\n      );\n\n      // Get matches\n      const matches = await query(\n        env,\n        `SELECT jm.*, j.title, j.company, j.location, j.status as job_status\n         FROM job_matches jm\n         JOIN jobs j ON jm.job_id = j.id\n         WHERE jm.candidate_id = ?\n         ORDER BY jm.match_score DESC`,\n        [candidateId]\n      );\n\n      // Get CRM interactions\n      const crmInteractions = await query(\n        env,\n        'SELECT * FROM crm_contacts WHERE candidate_id = ? ORDER BY interaction_date DESC',\n        [candidateId]\n      );\n\n      // Get candidate profile\n      const profile = await queryOne(\n        env,\n        'SELECT * FROM candidate_profiles WHERE user_id = ?',\n        [candidateId]\n      );\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({\n            ...candidate,\n            resumes: resumes || [],\n            matches: matches || [],\n            crm_interactions: crmInteractions || [],\n            profile: profile || null,\n          }),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error fetching candidate details:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Assign candidate to consultant (admin only)\n  const assignMatch = path.match(/^\\/api\\/candidates\\/(\\d+)\\/assign$/);\n  if (assignMatch && method === 'POST') {\n    const candidateId = assignMatch[1];\n    const authCheck = authorize('admin')(user);\n    if (authCheck) {\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: authCheck.error }),\n          { status: authCheck.status || 403, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n\n    try {\n      const body = await request.json();\n      const { consultant_id } = body;\n\n      // Verify consultant exists\n      const consultant = await queryOne(\n        env,\n        'SELECT id FROM users WHERE id = ? AND role IN (?, ?)',\n        [consultant_id, 'consultant', 'admin']\n      );\n      if (!consultant) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Consultant not found' }),\n            { status: 404, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      // Check if already assigned\n      const existingAssignment = await queryOne(\n        env,\n        'SELECT id FROM consultant_assignments WHERE consultant_id = ? AND candidate_id = ?',\n        [consultant_id, candidateId]\n      );\n\n      if (existingAssignment) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Candidate already assigned to this consultant' }),\n            { status: 400, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      const result = await execute(\n        env,\n        'INSERT INTO consultant_assignments (consultant_id, candidate_id) VALUES (?, ?)',\n        [consultant_id, candidateId]\n      );\n\n      const assignment = await queryOne(\n        env,\n        'SELECT * FROM consultant_assignments WHERE consultant_id = ? AND candidate_id = ?',\n        [consultant_id, candidateId]\n      );\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(assignment),\n          { status: 201, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error assigning candidate:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Unassign candidate from consultant (admin only)\n  const unassignMatch = path.match(/^\\/api\\/candidates\\/(\\d+)\\/assign\\/(\\d+)$/);\n  if (unassignMatch && method === 'DELETE') {\n    const candidateId = unassignMatch[1];\n    const consultantId = unassignMatch[2];\n    const authCheck = authorize('admin')(user);\n    if (authCheck) {\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: authCheck.error }),\n          { status: authCheck.status || 403, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n\n    try {\n      const assignment = await queryOne(\n        env,\n        'SELECT id FROM consultant_assignments WHERE consultant_id = ? AND candidate_id = ?',\n        [consultantId, candidateId]\n      );\n\n      if (!assignment) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Assignment not found' }),\n            { status: 404, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      await execute(\n        env,\n        'DELETE FROM consultant_assignments WHERE consultant_id = ? AND candidate_id = ?',\n        [consultantId, candidateId]\n      );\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ message: 'Candidate unassigned successfully' }),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error unassigning candidate:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Not found\n  return addCorsHeaders(\n    new Response(\n      JSON.stringify({ error: 'Not found' }),\n      { status: 404, headers: { 'Content-Type': 'application/json' } }\n    ),\n    env,\n    request\n  );\n}\n", "/**\n * Candidate Profiles routes for Cloudflare Workers\n */\n\nimport { query, queryOne, execute } from '../utils/db.js';\nimport { addCorsHeaders } from '../utils/cors.js';\nimport { authorize } from '../middleware/auth.js';\nimport { logActivity, logChanges } from '../utils/activityLog.js';\n\nexport async function handleCandidateProfiles(request, env, user) {\n  const url = new URL(request.url);\n  const path = url.pathname;\n  const method = request.method;\n\n  // Get candidate profile by user_id or direct ID\n  // Supports: /api/candidate-profiles/user/:id or /api/candidate-profiles/:id\n  const profileByUserIdMatch = path.match(/^\\/api\\/candidate-profiles\\/user\\/(\\d+)$/);\n  const profileByIdMatch = path.match(/^\\/api\\/candidate-profiles\\/(\\d+)$/);\n  \n  if ((profileByUserIdMatch || profileByIdMatch) && method === 'GET') {\n    const userId = profileByUserIdMatch ? profileByUserIdMatch[1] : profileByIdMatch[1];\n    \n    // Allow users to view their own profile, or consultants/admins to view any profile\n    if (user.id !== parseInt(userId) && !['consultant', 'admin'].includes(user.role)) {\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Access denied' }),\n          { status: 403, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n\n    try {\n      const profile = await queryOne(\n        env,\n        'SELECT * FROM candidate_profiles WHERE user_id = ?',\n        [userId]\n      );\n\n      if (!profile) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Profile not found' }),\n            { status: 404, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      // Parse JSON fields\n      if (profile.preferred_locations && typeof profile.preferred_locations === 'string') {\n        try {\n          profile.preferred_locations = JSON.parse(profile.preferred_locations);\n        } catch (e) {\n          profile.preferred_locations = [];\n        }\n      }\n\n      // Log view activity\n      await logActivity(env, {\n        userId: user.id,\n        entityType: 'candidate_profile',\n        entityId: profile.id,\n        action: 'view',\n        description: `Viewed candidate profile for user ${userId}`,\n        request\n      });\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(profile),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error fetching candidate profile:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Create or update candidate profile\n  if (path === '/api/candidate-profiles' && (method === 'POST' || method === 'PUT')) {\n    // Allow candidates to update their own profile, or consultants/admins to update any profile\n    try {\n      const body = await request.json();\n      const { user_id, ...profileData } = body;\n\n      if (!user_id) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'user_id is required' }),\n            { status: 400, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      // Check permissions\n      if (user.id !== parseInt(user_id) && !['consultant', 'admin'].includes(user.role)) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Access denied' }),\n            { status: 403, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      // Check if profile exists\n      const existing = await queryOne(\n        env,\n        'SELECT * FROM candidate_profiles WHERE user_id = ?',\n        [user_id]\n      );\n\n      let result;\n      let oldData = null;\n\n      if (existing) {\n        // Update existing profile\n        oldData = { ...existing };\n        \n        // Prepare update data\n        const updateFields = [];\n        const updateValues = [];\n        \n        const fields = [\n          'date_of_birth', 'address', 'city', 'state', 'country', 'zip_code',\n          'linkedin_url', 'portfolio_url', 'github_url', 'current_job_title',\n          'secondary_job_title', 'current_company', 'years_of_experience', 'availability',\n          'expected_salary_min', 'expected_salary_max', 'work_authorization',\n          'willing_to_relocate', 'preferred_locations', 'summary', 'additional_notes'\n        ];\n\n        for (const field of fields) {\n          if (profileData.hasOwnProperty(field)) {\n            updateFields.push(`${field} = ?`);\n            let value = profileData[field];\n            \n            // Handle special cases\n            if (field === 'preferred_locations' && Array.isArray(value)) {\n              value = JSON.stringify(value);\n            } else if (field === 'willing_to_relocate') {\n              value = value ? 1 : 0;\n            } else if (value === '' || value === null || value === undefined) {\n              value = null;\n            }\n            \n            updateValues.push(value);\n          }\n        }\n\n        if (updateFields.length === 0) {\n          return addCorsHeaders(\n            new Response(\n              JSON.stringify({ error: 'No fields to update' }),\n              { status: 400, headers: { 'Content-Type': 'application/json' } }\n            ),\n            env,\n            request\n          );\n        }\n\n        updateFields.push('updated_at = datetime(\"now\")');\n        updateValues.push(user_id);\n\n        await execute(\n          env,\n          `UPDATE candidate_profiles SET ${updateFields.join(', ')} WHERE user_id = ?`,\n          updateValues\n        );\n\n        // Get updated profile\n        result = await queryOne(\n          env,\n          'SELECT * FROM candidate_profiles WHERE user_id = ?',\n          [user_id]\n        );\n\n        // Log changes\n        await logChanges(env, {\n          userId: user.id,\n          entityType: 'candidate_profile',\n          entityId: result.id,\n          oldData,\n          newData: result,\n          request\n        });\n      } else {\n        // Create new profile\n        const insertFields = ['user_id'];\n        const insertValues = [user_id];\n        const placeholders = ['?'];\n\n        const fields = [\n          'date_of_birth', 'address', 'city', 'state', 'country', 'zip_code',\n          'linkedin_url', 'portfolio_url', 'github_url', 'current_job_title',\n          'secondary_job_title', 'current_company', 'years_of_experience', 'availability',\n          'expected_salary_min', 'expected_salary_max', 'work_authorization',\n          'willing_to_relocate', 'preferred_locations', 'summary', 'additional_notes'\n        ];\n\n        for (const field of fields) {\n          insertFields.push(field);\n          let value = profileData[field] || null;\n          \n          if (field === 'preferred_locations' && Array.isArray(value)) {\n            value = JSON.stringify(value);\n          } else if (field === 'willing_to_relocate') {\n            value = value ? 1 : 0;\n          }\n          \n          insertValues.push(value);\n          placeholders.push('?');\n        }\n\n        const insertResult = await execute(\n          env,\n          `INSERT INTO candidate_profiles (${insertFields.join(', ')}) VALUES (${placeholders.join(', ')})`,\n          insertValues\n        );\n\n        const profileId = insertResult.meta?.last_row_id || insertResult.lastInsertRowid;\n        \n        result = await queryOne(\n          env,\n          'SELECT * FROM candidate_profiles WHERE id = ?',\n          [profileId]\n        );\n\n        // Log creation\n        await logActivity(env, {\n          userId: user.id,\n          entityType: 'candidate_profile',\n          entityId: result.id,\n          action: 'create',\n          description: `Created candidate profile for user ${user_id}`,\n          request\n        });\n      }\n\n      // Parse JSON fields for response\n      if (result.preferred_locations && typeof result.preferred_locations === 'string') {\n        try {\n          result.preferred_locations = JSON.parse(result.preferred_locations);\n        } catch (e) {\n          result.preferred_locations = [];\n        }\n      }\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(result),\n          { status: existing ? 200 : 201, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error saving candidate profile:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error', message: error.message }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Not found\n  return addCorsHeaders(\n    new Response(\n      JSON.stringify({ error: 'Not found' }),\n      { status: 404, headers: { 'Content-Type': 'application/json' } }\n    ),\n    env,\n    request\n  );\n}\n", "/**\n * Activity logging utility for tracking dashboard activities\n */\n\nimport { execute } from './db.js';\n\n/**\n * Log an activity\n * @param {Object} env - Environment object with DB\n * @param {Object} params - Log parameters\n * @param {number} params.userId - User ID performing the action\n * @param {string} params.entityType - Type of entity ('candidate_profile', 'user', 'job', etc.)\n * @param {number} params.entityId - ID of the entity\n * @param {string} params.action - Action performed ('create', 'update', 'delete', 'view')\n * @param {string} [params.fieldName] - Field name being changed (for updates)\n * @param {string} [params.oldValue] - Previous value (for updates)\n * @param {string} [params.newValue] - New value (for updates)\n * @param {string} [params.description] - Human-readable description\n * @param {Object} [params.metadata] - Additional context (will be JSON stringified)\n * @param {Request} [params.request] - Request object for IP and user agent\n */\nexport async function logActivity(env, params) {\n  try {\n    const {\n      userId,\n      entityType,\n      entityId,\n      action,\n      fieldName = null,\n      oldValue = null,\n      newValue = null,\n      description = null,\n      metadata = null,\n      request = null\n    } = params;\n\n    // Extract IP and user agent from request if provided\n    let ipAddress = null;\n    let userAgent = null;\n    if (request) {\n      // Get IP from various headers (Cloudflare Workers)\n      ipAddress = request.headers.get('CF-Connecting-IP') || \n                  request.headers.get('X-Forwarded-For') || \n                  request.headers.get('X-Real-IP') || \n                  null;\n      userAgent = request.headers.get('User-Agent') || null;\n    }\n\n    // Stringify metadata if it's an object\n    const metadataStr = metadata ? JSON.stringify(metadata) : null;\n\n    // Truncate values if too long (SQLite TEXT limit considerations)\n    const truncate = (str, maxLen = 1000) => {\n      if (!str) return null;\n      const s = String(str);\n      return s.length > maxLen ? s.substring(0, maxLen) + '...' : s;\n    };\n\n    await execute(\n      env,\n      `INSERT INTO activity_logs (\n        user_id, entity_type, entity_id, action, field_name, \n        old_value, new_value, description, metadata, \n        ip_address, user_agent\n      ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`,\n      [\n        userId,\n        entityType,\n        entityId,\n        action,\n        fieldName,\n        truncate(oldValue),\n        truncate(newValue),\n        truncate(description, 2000),\n        metadataStr,\n        ipAddress,\n        truncate(userAgent, 500)\n      ]\n    );\n  } catch (error) {\n    // Don't fail the main operation if logging fails\n    console.error('Error logging activity:', error);\n  }\n}\n\n/**\n * Compare two objects and log changes\n * @param {Object} env - Environment object with DB\n * @param {Object} params - Log parameters\n * @param {number} params.userId - User ID performing the action\n * @param {string} params.entityType - Type of entity\n * @param {number} params.entityId - ID of the entity\n * @param {Object} params.oldData - Previous data\n * @param {Object} params.newData - New data\n * @param {Request} [params.request] - Request object\n */\nexport async function logChanges(env, params) {\n  const { userId, entityType, entityId, oldData, newData, request } = params;\n  \n  const changes = [];\n  const allKeys = new Set([...Object.keys(oldData || {}), ...Object.keys(newData || {})]);\n  \n  for (const key of allKeys) {\n    const oldVal = oldData?.[key];\n    const newVal = newData?.[key];\n    \n    // Skip if values are the same\n    if (oldVal === newVal) continue;\n    \n    // Skip internal fields\n    if (['id', 'created_at', 'updated_at'].includes(key)) continue;\n    \n    // Format values for display\n    const formatValue = (val) => {\n      if (val === null || val === undefined) return null;\n      if (typeof val === 'object') return JSON.stringify(val);\n      return String(val);\n    };\n    \n    changes.push({\n      fieldName: key,\n      oldValue: formatValue(oldVal),\n      newValue: formatValue(newVal)\n    });\n  }\n  \n  if (changes.length === 0) {\n    // No changes, just log the update action\n    await logActivity(env, {\n      userId,\n      entityType,\n      entityId,\n      action: 'update',\n      description: `${entityType} updated (no field changes detected)`,\n      request\n    });\n    return;\n  }\n  \n  // Log each change\n  for (const change of changes) {\n    await logActivity(env, {\n      userId,\n      entityType,\n      entityId,\n      action: 'update',\n      fieldName: change.fieldName,\n      oldValue: change.oldValue,\n      newValue: change.newValue,\n      description: `${change.fieldName} changed from \"${change.oldValue || 'empty'}\" to \"${change.newValue || 'empty'}\"`,\n      request\n    });\n  }\n  \n  // Also log a summary\n  await logActivity(env, {\n    userId,\n    entityType,\n    entityId,\n    action: 'update',\n    description: `${entityType} updated: ${changes.length} field(s) changed`,\n    metadata: { changedFields: changes.map(c => c.fieldName) },\n    request\n  });\n}\n\n", "/**\n * Timesheets routes for Cloudflare Workers\n */\n\nimport { addCorsHeaders } from '../utils/cors.js';\n\nexport async function handleTimesheets(request, env, user) {\n  return addCorsHeaders(\n    new Response(\n      JSON.stringify({ error: 'Timesheets endpoint not yet fully implemented' }),\n      { status: 501, headers: { 'Content-Type': 'application/json' } }\n    ),\n    env,\n    request\n  );\n}\n\n", "/**\n * KPIs routes for Cloudflare Workers\n */\n\nimport { query, queryOne, execute } from '../utils/db.js';\nimport { addCorsHeaders } from '../utils/cors.js';\nimport { buildFilterConditions } from './candidates.js';\n\nexport async function handleKPIs(request, env, user) {\n  const url = new URL(request.url);\n  const path = url.pathname;\n  const method = request.method;\n\n  // Get available metric types\n  if (path === '/api/kpis/metric-types' && method === 'GET') {\n    console.log('Fetching metric types for user:', user?.id, 'role:', user?.role);\n    \n    const metricTypes = [\n      { value: 'total_jobs', label: 'Total Active Jobs', roles: ['candidate', 'consultant', 'admin'] },\n      { value: 'total_matches', label: 'Total Matches', roles: ['candidate'] },\n      { value: 'average_match_score', label: 'Average Match Score', roles: ['candidate'] },\n      { value: 'total_resumes', label: 'Total Resumes', roles: ['candidate'] },\n      { value: 'assigned_candidates', label: 'Assigned Candidates', roles: ['consultant'] },\n      { value: 'pending_timesheets', label: 'Pending Timesheets', roles: ['consultant'] },\n      { value: 'total_users', label: 'Total Users', roles: ['admin'] },\n      { value: 'total_candidates', label: 'Total Candidates', roles: ['admin', 'consultant'] },\n    ];\n\n    if (!user || !user.role) {\n      console.error('User or user role is missing');\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'User role not found' }),\n          { status: 401, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n\n    const availableTypes = metricTypes.filter(mt => mt.roles.includes(user.role));\n    console.log('Available metric types for role', user.role, ':', availableTypes.length);\n    \n    return addCorsHeaders(\n      new Response(\n        JSON.stringify(availableTypes),\n        { status: 200, headers: { 'Content-Type': 'application/json' } }\n      ),\n      env,\n      request\n    );\n  }\n\n  // Get user's KPIs\n  if (path === '/api/kpis/my-kpis' && method === 'GET') {\n    try {\n      const kpis = await query(\n        env,\n        `SELECT * FROM kpis \n         WHERE user_id = ? AND is_active = 1\n         ORDER BY display_order, created_at DESC`,\n        [user.id]\n      );\n\n      // Parse query_config JSON if present\n      const parsedKpis = kpis.map(kpi => {\n        if (kpi.query_config && typeof kpi.query_config === 'string') {\n          try {\n            kpi.query_config = JSON.parse(kpi.query_config);\n          } catch (e) {\n            kpi.query_config = null;\n          }\n        }\n        return kpi;\n      });\n\n      // Calculate current values for each KPI\n      const kpisWithValues = await Promise.all(\n        parsedKpis.map(async (kpi) => {\n          let currentValue = null;\n\n          try {\n            switch (kpi.metric_type) {\n              case 'total_jobs':\n                const jobsResult = await query(\n                  env,\n                  \"SELECT COUNT(*) as count FROM jobs WHERE status = 'active'\"\n                );\n                currentValue = parseInt(jobsResult[0]?.count || 0);\n                break;\n\n              case 'total_matches':\n                const matchesResult = await query(\n                  env,\n                  'SELECT COUNT(*) as count FROM job_matches WHERE candidate_id = ?',\n                  [user.id]\n                );\n                currentValue = parseInt(matchesResult[0]?.count || 0);\n                break;\n\n              case 'average_match_score':\n                const avgScoreResult = await query(\n                  env,\n                  'SELECT AVG(match_score) as avg FROM job_matches WHERE candidate_id = ?',\n                  [user.id]\n                );\n                const avg = avgScoreResult[0]?.avg;\n                currentValue = avg ? parseFloat(avg).toFixed(2) : null;\n                break;\n\n              case 'total_resumes':\n                const resumesResult = await query(\n                  env,\n                  'SELECT COUNT(*) as count FROM resumes WHERE user_id = ?',\n                  [user.id]\n                );\n                currentValue = parseInt(resumesResult[0]?.count || 0);\n                break;\n\n              case 'assigned_candidates':\n                if (user.role === 'consultant') {\n                  const assignedResult = await query(\n                    env,\n                    'SELECT COUNT(*) as count FROM consultant_assignments WHERE consultant_id = ?',\n                    [user.id]\n                  );\n                  currentValue = parseInt(assignedResult[0]?.count || 0);\n                }\n                break;\n\n              case 'pending_timesheets':\n                if (user.role === 'consultant') {\n                  const timesheetsResult = await query(\n                    env,\n                    \"SELECT COUNT(*) as count FROM timesheets WHERE user_id = ? AND status = 'draft'\",\n                    [user.id]\n                  );\n                  currentValue = parseInt(timesheetsResult[0]?.count || 0);\n                }\n                break;\n\n              case 'total_users':\n                if (user.role === 'admin') {\n                  const usersResult = await query(\n                    env,\n                    'SELECT COUNT(*) as count FROM users WHERE is_active = 1'\n                  );\n                  currentValue = parseInt(usersResult[0]?.count || 0);\n                }\n                break;\n\n              case 'total_candidates':\n                const candidatesResult = await query(\n                  env,\n                  \"SELECT COUNT(*) as count FROM users WHERE role = 'candidate' AND is_active = 1\"\n                );\n                currentValue = parseInt(candidatesResult[0]?.count || 0);\n                break;\n\n              case 'custom_filter':\n                // Parse query_config to get filter conditions\n                try {\n                  const queryConfig = kpi.query_config ? JSON.parse(kpi.query_config) : null;\n                  if (queryConfig && queryConfig.type === 'candidate_filter') {\n                    let whereConditions = [\"u.role = 'candidate'\"];\n                    const filterParams = [];\n\n                    // Use new conditions format if available, fallback to old filters format for backward compatibility\n                    if (queryConfig.conditions && Array.isArray(queryConfig.conditions)) {\n                      const filterResult = buildFilterConditions(queryConfig.conditions);\n                      whereConditions.push(...filterResult.whereConditions);\n                      filterParams.push(...filterResult.params);\n                    } else if (queryConfig.filters) {\n                      // Legacy format support\n                      const filters = queryConfig.filters;\n                      \n                      if (filters.search) {\n                        whereConditions.push('(u.first_name LIKE ? OR u.last_name LIKE ? OR u.email LIKE ? OR cp.current_company LIKE ?)');\n                        const searchTerm = `%${filters.search}%`;\n                        filterParams.push(searchTerm, searchTerm, searchTerm, searchTerm);\n                      }\n\n                      if (filters.city) {\n                        whereConditions.push('cp.city LIKE ?');\n                        filterParams.push(`%${filters.city}%`);\n                      }\n\n                      if (filters.state) {\n                        whereConditions.push('cp.state LIKE ?');\n                        filterParams.push(`%${filters.state}%`);\n                      }\n\n                      if (filters.country) {\n                        whereConditions.push('cp.country LIKE ?');\n                        filterParams.push(`%${filters.country}%`);\n                      }\n\n                      if (filters.current_job_title) {\n                        whereConditions.push('cp.current_job_title LIKE ?');\n                        filterParams.push(`%${filters.current_job_title}%`);\n                      }\n\n                      if (filters.current_company) {\n                        whereConditions.push('cp.current_company LIKE ?');\n                        filterParams.push(`%${filters.current_company}%`);\n                      }\n\n                      if (filters.years_of_experience_min) {\n                        whereConditions.push('cp.years_of_experience >= ?');\n                        filterParams.push(parseInt(filters.years_of_experience_min));\n                      }\n\n                      if (filters.years_of_experience_max) {\n                        whereConditions.push('cp.years_of_experience <= ?');\n                        filterParams.push(parseInt(filters.years_of_experience_max));\n                      }\n\n                      if (filters.availability) {\n                        whereConditions.push('cp.availability = ?');\n                        filterParams.push(filters.availability);\n                      }\n\n                      if (filters.work_authorization) {\n                        whereConditions.push('cp.work_authorization LIKE ?');\n                        filterParams.push(`%${filters.work_authorization}%`);\n                      }\n\n                      if (filters.willing_to_relocate === 'true') {\n                        whereConditions.push('cp.willing_to_relocate = 1');\n                      } else if (filters.willing_to_relocate === 'false') {\n                        whereConditions.push('(cp.willing_to_relocate = 0 OR cp.willing_to_relocate IS NULL)');\n                      }\n\n                      if (filters.has_resume === 'true') {\n                        whereConditions.push('(SELECT COUNT(*) FROM resumes r WHERE r.user_id = u.id) > 0');\n                      } else if (filters.has_resume === 'false') {\n                        whereConditions.push('(SELECT COUNT(*) FROM resumes r WHERE r.user_id = u.id) = 0');\n                      }\n\n                      if (filters.has_matches === 'true') {\n                        whereConditions.push('(SELECT COUNT(*) FROM job_matches jm WHERE jm.candidate_id = u.id) > 0');\n                      } else if (filters.has_matches === 'false') {\n                        whereConditions.push('(SELECT COUNT(*) FROM job_matches jm WHERE jm.candidate_id = u.id) = 0');\n                      }\n\n                      if (filters.is_active === 'true') {\n                        whereConditions.push('u.is_active = 1');\n                      } else if (filters.is_active === 'false') {\n                        whereConditions.push('u.is_active = 0');\n                      }\n                    }\n\n                    const whereClause = whereConditions.join(' AND ');\n                    const countResult = await query(\n                      env,\n                      `SELECT COUNT(*) as count \n                       FROM users u\n                       LEFT JOIN candidate_profiles cp ON u.id = cp.user_id\n                       WHERE ${whereClause}`,\n                      filterParams\n                    );\n                    currentValue = parseInt(countResult[0]?.count || 0);\n                  }\n                } catch (error) {\n                  console.error('Error calculating custom filter KPI:', error);\n                  currentValue = null;\n                }\n                break;\n\n              default:\n                currentValue = null;\n            }\n          } catch (error) {\n            console.error(`Error calculating KPI value for ${kpi.metric_type}:`, error);\n            currentValue = null;\n          }\n\n          return {\n            ...kpi,\n            current_value: currentValue\n          };\n        })\n      );\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(kpisWithValues),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error fetching KPIs:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Create KPI\n  if (path === '/api/kpis' && method === 'POST') {\n    try {\n      const body = await request.json();\n      const { name, description, metric_type, display_order, query_config } = body;\n\n      if (!name || !metric_type) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Name and metric_type are required' }),\n            { status: 400, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      const queryConfigStr = query_config ? JSON.stringify(query_config) : null;\n\n      const result = await execute(\n        env,\n        `INSERT INTO kpis (user_id, name, description, metric_type, display_order, query_config)\n         VALUES (?, ?, ?, ?, ?, ?)`,\n        [user.id, name, description || '', metric_type, display_order || 0, queryConfigStr]\n      );\n\n      const kpiId = result.meta?.last_row_id || result.lastInsertRowid;\n      const newKpi = await queryOne(\n        env,\n        'SELECT * FROM kpis WHERE id = ?',\n        [kpiId]\n      );\n\n      // Parse query_config if present\n      if (newKpi.query_config && typeof newKpi.query_config === 'string') {\n        try {\n          newKpi.query_config = JSON.parse(newKpi.query_config);\n        } catch (e) {\n          newKpi.query_config = null;\n        }\n      }\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(newKpi),\n          { status: 201, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error creating KPI:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Update KPI\n  const updateMatch = path.match(/^\\/api\\/kpis\\/(\\d+)$/);\n  if (updateMatch && method === 'PUT') {\n    const kpiId = updateMatch[1];\n    try {\n      // Verify KPI belongs to user\n      const existingKpi = await queryOne(\n        env,\n        'SELECT * FROM kpis WHERE id = ? AND user_id = ?',\n        [kpiId, user.id]\n      );\n\n      if (!existingKpi) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'KPI not found' }),\n            { status: 404, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      const body = await request.json();\n      const { name, description, metric_type, display_order, is_active, query_config } = body;\n\n      const queryConfigStr = query_config !== undefined \n        ? (query_config ? JSON.stringify(query_config) : null)\n        : existingKpi.query_config;\n\n      await execute(\n        env,\n        `UPDATE kpis SET name = ?, description = ?, metric_type = ?, display_order = ?, \n         is_active = ?, query_config = ?, updated_at = datetime('now')\n         WHERE id = ?`,\n        [\n          name,\n          description || '',\n          metric_type,\n          display_order || 0,\n          is_active !== undefined ? (is_active ? 1 : 0) : existingKpi.is_active,\n          queryConfigStr,\n          kpiId\n        ]\n      );\n\n      const updatedKpi = await queryOne(\n        env,\n        'SELECT * FROM kpis WHERE id = ?',\n        [kpiId]\n      );\n\n      // Parse query_config if present\n      if (updatedKpi.query_config && typeof updatedKpi.query_config === 'string') {\n        try {\n          updatedKpi.query_config = JSON.parse(updatedKpi.query_config);\n        } catch (e) {\n          updatedKpi.query_config = null;\n        }\n      }\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(updatedKpi),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error updating KPI:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Delete KPI\n  const deleteMatch = path.match(/^\\/api\\/kpis\\/(\\d+)$/);\n  if (deleteMatch && method === 'DELETE') {\n    const kpiId = deleteMatch[1];\n    try {\n      // Verify KPI belongs to user\n      const existingKpi = await queryOne(\n        env,\n        'SELECT * FROM kpis WHERE id = ? AND user_id = ?',\n        [kpiId, user.id]\n      );\n\n      if (!existingKpi) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'KPI not found' }),\n            { status: 404, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      await execute(\n        env,\n        'DELETE FROM kpis WHERE id = ?',\n        [kpiId]\n      );\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ message: 'KPI deleted successfully' }),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error deleting KPI:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Not found\n  return addCorsHeaders(\n    new Response(\n      JSON.stringify({ error: 'Not found' }),\n      { status: 404, headers: { 'Content-Type': 'application/json' } }\n    ),\n    env,\n    request\n  );\n}\n", "/**\n * Users routes for Cloudflare Workers\n */\n\nimport { addCorsHeaders } from '../utils/cors.js';\nimport { authorize } from '../middleware/auth.js';\n\nexport async function handleUsers(request, env, user) {\n  const authError = authorize('admin')(user);\n  if (authError) {\n    return addCorsHeaders(\n      new Response(\n        JSON.stringify({ error: authError.error }),\n        { status: authError.status, headers: { 'Content-Type': 'application/json' } }\n      ),\n      env,\n      request\n    );\n  }\n\n  return addCorsHeaders(\n    new Response(\n      JSON.stringify({ error: 'Users endpoint not yet fully implemented' }),\n      { status: 501, headers: { 'Content-Type': 'application/json' } }\n    ),\n    env,\n    request\n  );\n}\n\n", "/**\n * Groups routes for Cloudflare Workers\n */\n\nimport { addCorsHeaders } from '../utils/cors.js';\n\nexport async function handleGroups(request, env, user) {\n  return addCorsHeaders(\n    new Response(\n      JSON.stringify({ error: 'Groups endpoint not yet fully implemented' }),\n      { status: 501, headers: { 'Content-Type': 'application/json' } }\n    ),\n    env,\n    request\n  );\n}\n\n", "/**\n * Permissions routes for Cloudflare Workers\n */\n\nimport { addCorsHeaders } from '../utils/cors.js';\n\nexport async function handlePermissions(request, env, user) {\n  return addCorsHeaders(\n    new Response(\n      JSON.stringify({ error: 'Permissions endpoint not yet fully implemented' }),\n      { status: 501, headers: { 'Content-Type': 'application/json' } }\n    ),\n    env,\n    request\n  );\n}\n\n", "/**\n * CRM routes for Cloudflare Workers\n */\n\nimport { addCorsHeaders } from '../utils/cors.js';\n\nexport async function handleCRM(request, env, user) {\n  return addCorsHeaders(\n    new Response(\n      JSON.stringify({ error: 'CRM endpoint not yet fully implemented' }),\n      { status: 501, headers: { 'Content-Type': 'application/json' } }\n    ),\n    env,\n    request\n  );\n}\n\n", "/**\n * Activity Logs routes for Cloudflare Workers\n */\n\nimport { query } from '../utils/db.js';\nimport { addCorsHeaders } from '../utils/cors.js';\nimport { authorize } from '../middleware/auth.js';\n\nexport async function handleActivityLogs(request, env, user) {\n  const url = new URL(request.url);\n  const path = url.pathname;\n  const method = request.method;\n\n  // Get activity logs for an entity\n  // GET /api/activity-logs?entity_type=candidate_profile&entity_id=123\n  if (path === '/api/activity-logs' && method === 'GET') {\n    // Only consultants and admins can view activity logs\n    const authCheck = authorize('consultant', 'admin')(user);\n    if (authCheck) {\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: authCheck.error }),\n          { status: authCheck.status || 403, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n\n    try {\n      const { searchParams } = url;\n      const entityType = searchParams.get('entity_type');\n      const entityId = searchParams.get('entity_id');\n      const limit = parseInt(searchParams.get('limit') || '100');\n      const offset = parseInt(searchParams.get('offset') || '0');\n      const search = searchParams.get('search');\n      const dateFrom = searchParams.get('date_from');\n      const dateTo = searchParams.get('date_to');\n      const action = searchParams.get('action');\n\n      let sql = `\n        SELECT \n          al.*,\n          u.first_name || ' ' || u.last_name as user_name,\n          u.email as user_email\n        FROM activity_logs al\n        LEFT JOIN users u ON al.user_id = u.id\n        WHERE 1=1\n      `;\n      const params = [];\n\n      if (entityType) {\n        sql += ' AND al.entity_type = ?';\n        params.push(entityType);\n      }\n\n      if (entityId) {\n        sql += ' AND al.entity_id = ?';\n        params.push(entityId);\n      }\n\n      // Debug logging\n      console.log('Activity logs query:', {\n        entityType,\n        entityId,\n        search,\n        dateFrom,\n        dateTo,\n        action,\n        limit,\n        offset\n      });\n\n      if (action) {\n        sql += ' AND al.action = ?';\n        params.push(action);\n      }\n\n      if (search) {\n        sql += ' AND (al.description LIKE ? OR al.field_name LIKE ? OR u.first_name || \\' \\' || u.last_name LIKE ?)';\n        const searchTerm = `%${search}%`;\n        params.push(searchTerm, searchTerm, searchTerm);\n      }\n\n      if (dateFrom) {\n        sql += ' AND DATE(al.created_at) >= DATE(?)';\n        params.push(dateFrom);\n      }\n\n      if (dateTo) {\n        sql += ' AND DATE(al.created_at) <= DATE(?)';\n        params.push(dateTo);\n      }\n\n      sql += ' ORDER BY al.created_at DESC LIMIT ? OFFSET ?';\n      params.push(limit, offset);\n\n      const logs = await query(env, sql, params);\n\n      // Parse metadata JSON if present\n      const parsedLogs = logs.map(log => {\n        if (log.metadata && typeof log.metadata === 'string') {\n          try {\n            log.metadata = JSON.parse(log.metadata);\n          } catch (e) {\n            log.metadata = null;\n          }\n        }\n        return log;\n      });\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(parsedLogs),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error fetching activity logs:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error' }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Not found\n  return addCorsHeaders(\n    new Response(\n      JSON.stringify({ error: 'Not found' }),\n      { status: 404, headers: { 'Content-Type': 'application/json' } }\n    ),\n    env,\n    request\n  );\n}\n\n", "/**\n * Job Roles routes for Cloudflare Workers\n */\n\nimport { query, queryOne, execute } from '../utils/db.js';\nimport { addCorsHeaders } from '../utils/cors.js';\nimport { authorize } from '../middleware/auth.js';\n\nexport async function handleJobRoles(request, env, user) {\n  const url = new URL(request.url);\n  const path = url.pathname;\n  const method = request.method;\n\n  // Get all job roles\n  if (path === '/api/job-roles' && method === 'GET') {\n    try {\n      const { searchParams } = url;\n      const includeInactive = searchParams.get('include_inactive') === 'true';\n      \n      let sql = 'SELECT * FROM job_roles';\n      const params = [];\n      \n      if (!includeInactive) {\n        sql += ' WHERE is_active = 1';\n      }\n      \n      sql += ' ORDER BY created_at ASC';\n      \n      const roles = await query(env, sql, params);\n      \n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(roles),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error fetching job roles:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error', details: error.message }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Get single job role\n  if (path.startsWith('/api/job-roles/') && method === 'GET') {\n    const authCheck = authorize('admin')(user);\n    if (authCheck) {\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: authCheck.error }),\n          { status: authCheck.status || 403, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n\n    try {\n      const roleId = parseInt(path.split('/').pop());\n      \n      if (isNaN(roleId)) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Invalid role ID' }),\n            { status: 400, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      const role = await queryOne(env, 'SELECT * FROM job_roles WHERE id = ?', [roleId]);\n      \n      if (!role) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Job role not found' }),\n            { status: 404, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(role),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error fetching job role:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error', details: error.message }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Create job role (admin only)\n  if (path === '/api/job-roles' && method === 'POST') {\n    const authCheck = authorize('admin')(user);\n    if (authCheck) {\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: authCheck.error }),\n          { status: authCheck.status || 403, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n\n    try {\n      const body = await request.json();\n      const { name, description, is_active } = body;\n\n      if (!name || !name.trim()) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Name is required' }),\n            { status: 400, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      // Check if role with same name already exists\n      const existing = await queryOne(\n        env,\n        'SELECT id FROM job_roles WHERE name = ?',\n        [name.trim()]\n      );\n\n      if (existing) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Job role with this name already exists' }),\n            { status: 409, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      const result = await execute(\n        env,\n        `INSERT INTO job_roles (name, description, is_active, created_at, updated_at)\n         VALUES (?, ?, ?, datetime('now'), datetime('now'))`,\n        [\n          name.trim(),\n          description || null,\n          is_active !== undefined ? (is_active ? 1 : 0) : 1\n        ]\n      );\n\n      const newRole = await queryOne(\n        env,\n        'SELECT * FROM job_roles WHERE id = ?',\n        [result.meta.last_row_id]\n      );\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(newRole),\n          { status: 201, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error creating job role:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error', details: error.message }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Update job role (admin only)\n  if (path.startsWith('/api/job-roles/') && method === 'PUT') {\n    const authCheck = authorize('admin')(user);\n    if (authCheck) {\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: authCheck.error }),\n          { status: authCheck.status || 403, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n\n    try {\n      const roleId = parseInt(path.split('/').pop());\n      const body = await request.json();\n      const { name, description, is_active } = body;\n\n      if (isNaN(roleId)) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Invalid role ID' }),\n            { status: 400, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      // Check if role exists\n      const existing = await queryOne(env, 'SELECT * FROM job_roles WHERE id = ?', [roleId]);\n      if (!existing) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Job role not found' }),\n            { status: 404, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      // Check if name is being changed and if new name already exists\n      if (name && name.trim() !== existing.name) {\n        const nameExists = await queryOne(\n          env,\n          'SELECT id FROM job_roles WHERE name = ? AND id != ?',\n          [name.trim(), roleId]\n        );\n\n        if (nameExists) {\n          return addCorsHeaders(\n            new Response(\n              JSON.stringify({ error: 'Job role with this name already exists' }),\n              { status: 409, headers: { 'Content-Type': 'application/json' } }\n            ),\n            env,\n            request\n          );\n        }\n      }\n\n        await execute(\n          env,\n          `UPDATE job_roles \n         SET name = ?, description = ?, is_active = ?, updated_at = datetime('now')\n         WHERE id = ?`,\n          [\n            name !== undefined ? name.trim() : existing.name,\n            description !== undefined ? description : existing.description,\n            is_active !== undefined ? (is_active ? 1 : 0) : existing.is_active,\n            roleId\n          ]\n        );\n\n      const updatedRole = await queryOne(env, 'SELECT * FROM job_roles WHERE id = ?', [roleId]);\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify(updatedRole),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error updating job role:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error', details: error.message }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  // Delete job role (admin only)\n  if (path.startsWith('/api/job-roles/') && method === 'DELETE') {\n    const authCheck = authorize('admin')(user);\n    if (authCheck) {\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: authCheck.error }),\n          { status: authCheck.status || 403, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n\n    try {\n      const roleId = parseInt(path.split('/').pop());\n\n      if (isNaN(roleId)) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Invalid role ID' }),\n            { status: 400, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      // Check if role exists\n      const existing = await queryOne(env, 'SELECT * FROM job_roles WHERE id = ?', [roleId]);\n      if (!existing) {\n        return addCorsHeaders(\n          new Response(\n            JSON.stringify({ error: 'Job role not found' }),\n            { status: 404, headers: { 'Content-Type': 'application/json' } }\n          ),\n          env,\n          request\n        );\n      }\n\n      // Soft delete by setting is_active to 0\n      await execute(\n        env,\n        `UPDATE job_roles SET is_active = 0, updated_at = datetime('now') WHERE id = ?`,\n        [roleId]\n      );\n\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ message: 'Job role deleted successfully' }),\n          { status: 200, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    } catch (error) {\n      console.error('Error deleting job role:', error);\n      return addCorsHeaders(\n        new Response(\n          JSON.stringify({ error: 'Server error', details: error.message }),\n          { status: 500, headers: { 'Content-Type': 'application/json' } }\n        ),\n        env,\n        request\n      );\n    }\n  }\n\n  return addCorsHeaders(\n    new Response(\n      JSON.stringify({ error: 'Not found' }),\n      { status: 404, headers: { 'Content-Type': 'application/json' } }\n    ),\n    env,\n    request\n  );\n}\n\n", "/**\n * Cloudflare Workers Backend\n * Main entry point for the API\n */\n\nimport { handleRequest } from './src/router.js';\n\nexport default {\n  async fetch(request, env, ctx) {\n    try {\n      return await handleRequest(request, env, ctx);\n    } catch (error) {\n      console.error('Unhandled error:', error);\n      return new Response(\n        JSON.stringify({ error: 'Internal server error', message: error.message }),\n        {\n          status: 500,\n          headers: { 'Content-Type': 'application/json' },\n        }\n      );\n    }\n  },\n};\n\n"],
  "mappings": "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",
  "names": ["queryOne", "authenticate", "autoMatchByClassification", "query", "response"]
}
